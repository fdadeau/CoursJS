<!doctype html>
<html>

<head>
    <meta charset="UTF-8">
    
    <link rel="stylesheet" href="../css/slides.css" type="text/css">
    <script src="../js/slides.js"></script>
    
    <script src="../js/codemirror.js"></script>
    <link rel="stylesheet" href="../css/codemirror.css">
    <script src="../js/javascript.js"></script>
    <script src="../js/css.js"></script>
    <script src="../js/xml.js"></script>
    <script src="../js/htmlmixed.js"></script>
    
    <script src="../js/playground.js"></script>
    <link rel="stylesheet" href="../css/playground.css">
    
    <title>Web avancé - Chapitre 2 - Javascript, côté client</title>
    
</head>
    
    
<!---

Javascript côté client (3)

- Manipulation du DOM, validation de formulaires, BOM, cookies 
- Evénements, 
- Dessin dans les canvas (+Polyfills), 
- AJAX, async, wait, promises
- API HTML5 intéressantes : Mobile (touch events), Storage, Camera, Géolocalisation, GoogleMaps
- Bibliothèques intéressantes : jQuery, ReactJS | AngularJS

-->

<body>


<mask>
    <img src="../images/logo_ufc.png" class="top right padding" style="height: 7vh;">
<!--    <img src="../images/abeille.png" class="top right" style="height: 20vh;">
    <img src="../images/logo-femto.png" class="top left padding" style="height: 7vh;">-->
</mask>    
    
<slideshow>

    <title>Chapitre 2 - Javascript, côté client</title>
    
    <slide>
        <title1>@ref{title}</title1>
        <title2>Cours &ldquo;Web avancé&rdquo; - Licence Info 3<sup>ème</sup> année</title2>
        <title3>Frédéric Dadeau - <a href="mailto:frederic.dadeau@univ-fcomte.fr">frederic.dadeau@univ-fcomte.fr</a></title3>
    </slide>
    
    
    <slide>
        <title>Contenu de ce chapitre</title>
    
        <p>Après avoir vu le langage Javascript en lui-même, nous allons nous concentrer désormais 
        sur les environnements d'exécution de ce langage, d'abord côté client, puis côté serveur.  </p>
        
        <p>Côté client, c'est dans un navigateur web que les scripts Javascript vont s'exécuter. </p>
        
        <p style="font-style: italic; text-align: center;">&ldquo;The browser is a really hostile programming environment.&rdquo; --Douglas Crockford</p>
        
        <p>Mais on va quand même essayer de s'en sortir...</p>
        
    </slide>
    
    <slide>
        <title>Où placer son code Javascript ?</title>
        
        <block title="Dans une balise script">
            <p>La façon la plus naturelle d'exécuter du code Javascript dans le navigateur est de placer celui-ci dans une balise <code>&lt;script&gt;</code>.</p>
            <p>Cette balise peut être placée dans l'entête de la page (marqueur <code>&lt;head&gt;</code>) ou dans le corps du document 
            (marqueur <code>&lt;body&gt;</code>). </p>
            
            <p>La balise <code>script</code> admet un attribut <code>src</code> qui permet également de désigner un fichier externe
            à la page contenant le code Javascript, généralement enregistré avec une extension <code>.js</code>.</p>
        </block>
        
        <block title="Exemple de code Javascript">
            <div class="playground h30" data-href="./examples/jsBrowser1.html" data-opened="html"></div>
        </block>
        
    </slide>
    
    
    <slide>
        <title>Où placer son code Javascript ?</title>
        
        <block title="Dans les marqueurs">
            <p>Il est également possible d'écrire des portions de code dans les événements associés aux marqueurs (généralement 
                préfixés par <code>onXXX</code>, comme par exemple <code>onclick</code>, <code>onfocus</code>, <code>onload</code>, etc. 
            (voir <url>https://www.w3schools.com/tags/ref_eventattributes.asp</url> pour une liste complète)</p>
            <p>En général ces portions de code seront relativement courtes, le plus souvent il s'agira d'un appel de 
            fonction déclarée dans une balise <code>script</code> pour ne pas surcharger le code HTML.</p>
        </block>
        
        <block title="Exemple de code Javascript">
            <div class="playground nocss h20" data-href="./examples/jsBrowser2.html" data-opened="html"></div>
        </block>
    
    </slide>    
    
    <slide>
        <title>Contenu du chapitre</title>
    
        <p>Les deux exemples précédents vous donnent un aperçu de ce qu'il est possible de faire avec Javascript : 
        répondre à des événements au sein du navigateur, modifier le contenu de la page affichée, utiliser une 
            fonction native fournie par l'environnement d'exécution (<code>alert(...)</code>), etc. </p>
        
        <p>Ce chapitre a pour objectif de faire un tour d'horizon des possibilités de Javascript côté client (navigateur). </p>
        
        <p>Bien évidemment, nous ne pourrons pas être 100% exhaustifs. Ce sera à vous d'être un peu curieux, et de faire de
        la veille technologique sur les dernières évolutions du langage (une fois par an) et des navigateurs API 
        proposées (fréquence plus variable/aléatoire). </p>
        
        <p onslide="2">Ceci étant dit, amusons-nous un peu !</p>
        
    </slide>
    
    <slide outline class="no-navigation section">
        <title>Plan du chapitre</title>
    </slide>

    <section>Manipulation du Document Object Model</section>
    
    <slide outline class="no-navigation section currentSection">
        <title>Plan du chapitre</title>
    </slide>
    
    <slide>
        <title>Manipuler le DOM avec Javascript</title>
    
        <block title="Définition officielle du DOM (W3C)">
            <p style="font-style: italic;">&ldquo;The W3C Document Object Model (DOM) is a platform and language-neutral interface that allows programs and scripts to dynamically access and update the content, structure, and style of a document.&rdquo;</p></block>
        
        <block title="Un DOM pas vraiment rigide">
        <p>Javascript peut manipuler le DOM d'une page, et en faire ce qu'il veut :</p>
        <ul>
            <li>changer les éléments HTML d'une page</li>    
            <li>changer les attributs des éléments HTML d'une page</li>
            <li>changer le style CSS d'une page</li>
            <li>supprimer des élements HTML et des attributs</li>
            <li>ajouter de nouveaux éléments HTML et attributs</li>
            <li>réagir aux événements HTML générés par une page</li>
            <li>créer de nouveaux événements dans une page</li>
        </ul>
        </block>
    </slide>
    
    <subsection>L'objet <code>document</code></subsection>
    
    <slide>
        <title>Manipuler le DOM avec Javascript</title>
        
        <block title="Le DOM et ses objets">
            <p>Pour réaliser toutes ces actions, Javascript va s'appuyer sur un ensemble de méthodes portées par les 
            différentes entités HTML. </p>
            <p>Chaque entité HTML va ainsi être un objet qui propose des propriétés (influençant son rendu ou son comportement) 
            et des méthodes (permettant l'évolution de ces propriétés ou l'accès à d'autres éléments). </p>
        </block>
        
        <block title="Un premier exemple assez intuitif">
            <div class="playground nocss h20" data-href="./examples/jsBrowser3.html" data-opened="js"></div>
        </block>
    </slide>

    <slide>
        <title>@ref{currentSubsection}</title>
        
        <block title="Qu'est-ce que c'est ?">
        <p>L'objet <code>document</code> représente la page web. C'est lui qui possède, et permet d'accéder à,
            tous les éléments de la page. </p> 
        </block>
        
        <block title="L'objet <code>document</code>">
        <p>Cet objet contient des méthodes pour :</p>
        <ul>
            <li>récupérer des éléments : par identifiant (<code>getElementById(<i>id</i>)</code>), par nom de
            marqueur (<code>getElementsByTagName(<i>name</i>)</code>), ou par classe (<code>getElementsByClassName(<i>class</i>)</code>)
            </li>    
            <li>créer des éléments et gérer le DOM : <code>createElement(<i>name</i>)</code>, <code>appendChild(<i>element</i>)</code>, 
            etc.</li>
            <li>écrire du code dans le flux HTML du document avec <code>write(<i>text</i>)</code></li>
        </ul>
        </block>
        
    </slide>
    
    <slide>
        <title>@ref{currentSubsection}</title>
        
        <block title="Propriétés de l'objet <code>document</code>">
        <p>Quelques propriétés intéressantes, qu'il faut voir comme des raccourcis pour accéder aux objets de la page. </p>
        <table>
            <tr>
                <td>Propriété</td><td>Description</td>
            </tr>    
            <tr>
                <td><code>document.body</code></td><td>L'élément <code>&lt;body&gt;</code> de la page.</td>
            </tr>
            <tr>
                <td><code>document.cookie</code></td><td>Le cookie de la page (détaillé plus tard).</td>
            </tr>
            <tr>
                <td><code>document.doctype</code></td><td>Le doctype du document.</td>
            </tr>
            <tr>
                <td><code>document.documentElement</code></td><td>L'élément <code>&lt;html&gt;</code> de la page.</td>
            </tr>
            <tr>
                <td><code>document.forms</code></td><td>La collection des éléments <code>&lt;form&gt;</code> de la page.</td>
            </tr>
            <tr>
                <td><code>document.head</code></td><td>L'élément <code>&lt;head&gt;</code> de la page.</td>
            </tr>
            <tr>
                <td><code>document.images</code></td><td>La collection des éléments <code>&lt;img&gt;</code> de la page.</td>
            </tr>
            <tr>
                <td><code>document.links</code></td><td>La collection des liens <code>&lt;a&gt;</code> ou <code>&lt;area&gt;</code> de la page.</td>
            </tr>
            <tr>
                <td><code>document.referrer</code></td><td>L'URI de la page d'origine (ayant mené sur la page actuelle).</td>
            </tr>
            <tr>
                <td><code>document.scripts</code></td><td>La collection des éléments <code>&lt;script&gt;</code> de la page.</td>
            </tr>
            <tr>
                <td><code>document.title</code></td><td>L'élément <code>&lt;title&gt;</code> de la page.</td>
            </tr>
            <tr>
                <td><code>document.URL</code></td><td>L'URL complète du document.</td>
            </tr>
        </table>
        </block>
        
    </slide>
    
    <slide>
        <title>Les objets du DOM</title>
        
        <block title="Rechercher des éléments HTML">
            <p>Javascript permet, à partir de l'objet <code>document</code> de récupérer les éléments </p>
            <table>
                <tr>
                    <td>Méthode</td><td>Description</td>
                </tr>
                <tr>
                    <td><code>document.getElementById(<i>id</i>)</code></td><td>Renvoie l'élément du document qui a pour identifiant <code><i>id</i></code>, ou <code>null</code> si aucun n'existe. 
                    <br>Pour rappel, les identifiants doivent être uniques au sein d'un page.</td>
                </tr>    
                <tr>
                    <td><code>document.getElementsByTagName(<i>name</i>)</code></td><td>Renvoie une collection d'éléments ayant pour nom 
                    de marqueur<code><i>name</i></code>.</td>
                </tr>    
                <tr>
                    <td><code>document.getElementsByClassName(<i>class</i>)</code></td><td>Renvoie une collection d'éléments ayant pour classe 
                    <code><i>class</i></code> parmi les classes déclarées.</td>
                </tr>    
                <tr>
                    <td><code>document.querySelector(<i>selecteur</i>)</code></td><td>Renvoie le premier élément du document qui correspond 
                    au sélecteur en paramètre ou <code>null</code> si aucun.</td>
                </tr>    
                <tr>
                    <td><code>document.querySelectorAll(<i>selecteur</i>)</code></td><td>Renvoie une collection d'éléments du document qui 
                    correspondent au sélecteur en paramètre.</td>
                </tr>    
                <tr>
                    <td><code>document.links</code><br><code>document.scripts</code><br>...</td><td>Renvoie un objet ou une collection d'objets 
                    correspondant à collection demandée (voir diapo précédente).</td>
                </tr>    
            </table>
        </block>

        <p>Pour une description complète des propriétés et méthodes de l'objet <code>document</code> : <br>
        <url>https://www.w3schools.com/jsref/dom_obj_document.asp</url></p>
        
    </slide>
    
    <subsection>Le DOM et ses éléments</subsection>
    
    <slide>
        <title>Naviguer dans le DOM</title>
    
        <block title="Les noeuds du DOM">
            <p>D'après le standard W3C HTML DOM, tout ce qui est dans un document HTML est un noeud : le document en lui-même, 
            les éléments HTML sont des noeuds, le texte à l'intérieur d'un élément HTML est un noeud texte, les commentaires
            sont des noeuds de commentaires. </p>
            
            <p>Javascript permet de naviguer d'un noeud à l'autre, et bien sûr de créer de nouveaux noeuds, 
            de modifier, de supprimer ou de remplacer des noeuds existants. </p>
        </block>
        
         <block title="Utiliser les propriétés des noeuds pour naviguer dans l'arbre DOM">
            <p>Pour accéder aux noeuds de l'arbre DOM, on peut utiliser les propriétés suivantes (en lecture seule) à partir d'un noeud <code>n</code>:</p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>n.parentNode</code></td><td>Noeud père (ancêtre direct)</td></tr>
                <tr><td><code>n.childNodes[i]</code></td><td>Enfant (descendant direct) à l'indice <code>i</code> entre <code>0</code> et 
                    <code>n.childNodes.length-1</code></td></tr>
                <tr><td><code>n.firstChild</code></td><td>Premier enfant (équivalent à <code>n.childNodes[0]</code>)</td></tr>
                <tr><td><code>n.lastChild</code></td><td>Dernier enfant (équivalent à <code>n.childNodes[n.childNodes.length-1]</code>)</td></tr>
                <tr><td><code>n.nextSibling</code></td><td>Noeud frère suivant (pas d'équivalent simple)</td></tr>
                <tr><td><code>n.previousSibling</code></td><td>Noeud frère précédent (pas d'équivalent simple)</td></tr>
            </table>
        </block>    
    </slide>
    
    
    <slide>
        <title>Naviguer dans le DOM</title>
    
        <block title="Difference entre Element et Node">
            <p>Dans le DOM, les éléments sont des noeuds particuliers. Les noeuds peuvent également être du texte ou des 
            commentaires. Pour ne raisonner que sur des éléments, les objets éléments proposent les propriétés suivantes : </p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>n.parentElement</code></td><td>Elément père ou <code>null</code> si le père n'est pas un élément</td></tr>
                <tr><td><code>n.children[i]</code></td><td>Elément enfant (descendant direct) à l'indice <code>i</code> entre <code>0</code> et 
                    <code>n.childElementCount-1</code></td></tr>
                <tr><td><code>n.firstElementChild</code></td><td>Premier enfant élément (équivalent à <code>n.children[0]</code>)</td></tr>
                <tr><td><code>n.lastElementChild</code></td><td>Dernier enfant élément (équivalent à <code>n.children[n.childElementCount.length-1]</code>)</td></tr>
                <tr><td><code>n.nextElementSibling</code></td><td>Elément frère suivant  (pas d'équivalent simple)</td></tr>
                <tr><td><code>n.previousElementSibling</code></td><td>Elément frère précédent  (pas d'équivalent simple)</td></tr>
            </table>
            <p>Ces propriétés sont également en lecture seule (read-only). </p>
        </block>
        
    </slide>
    
    <slide>
        <title>Accéder au contenu des noeuds</title>

        <block title="Propriétés de tous les noeuds">
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>n.nodeName</code></td><td>Renvoie le nom du noeud (équivalent au <code>tagName</code> pour les éléments) - read-only</td></tr>
                <tr><td><code>n.nodeType</code></td><td>Renvoie un entier donnant le type du noeud (par ex. <code>1</code> pour un élément, <code>3</code> pour un noeud texte, <code>8</code> pour un commentaire) - read-only</td></tr>
            </table> 
        </block>    
        
        <block title="Propriétés/méthodes des éléments">
            <table>
                <tr><td>Propriété/méthode</td><td>Description</td></tr>
                <tr><td><code>e.tagName</code></td><td>Renvoie le NOM DU TAG (en majuscules)</td></tr>
                <tr><td><code>e.querySelector(selecteur)</code></td><td>Renvoie le descendant de <code>e</code> qui satisfait le sélecteur <code>selecteur</code>.</td></tr>
                <tr><td><code>e.querySelectorAll(selecteur)</code></td><td>Renvoie la liste des descendants de <code>e</code> qui satisfont tous le sélecteur.</td></tr>
                <tr><td><code>e.getElementsByTagName(name)</code></td><td>Renvoie la liste des descendants de <code>e</code> qui ont pour tag <code>name</code>.</td></tr>
                <tr><td><code>e.getElementsByClassName(class)</code></td><td>Renvoie la liste des descendants de <code>e</code> qui ont pour classe <code>name</code>.</td></tr>
            </table>
        </block>

    </slide>

    <slide>
        <title>Accéder aux éléments</title>
        
        <block title="Contenu des noeuds">
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>n.nodeValue</code></td><td>Définit/renvoie la valeur du noeud (<code>null</code> si le noeud est un élément). </td></tr>
                <tr><td><code>n.innerHTML</code></td><td>Définit/renvoie le code HTML du contenu du noeud. </td></tr>
                <tr><td><code>n.textContent</code></td><td>Définit/renvoie le contenu texte du noeud et de tous ses descendants. </td></tr>
            </table>
        </block>
        <block title="Accès aux attributs des éléments">
             <table>
                <tr><td>Propriété/méthode</td><td>Description</td></tr>
                <tr><td><code>e.hasAttributes()</code></td><td>Renvoie <code>true</code> si l'élément <code>e</code> a des attributs.</td></tr>
                <tr><td><code>e.attributes</code></td><td>Renvoie la collection d'objets {name,value} des attributs d'un élément.</td></tr>
                <tr><td><code>e.getAttribute(<i>name</i>)</code></td><td>Renvoie la valeur de l'attribut <code><i>name</i></code> pour l'élément <code>e</code>.</td></tr>
                <tr><td><code>e.setAttribute(<i>name</i>,<i>value</i>)</code></td><td>Définit la valeur de l'attribut <code><i>name</i></code>
                    pour l'élément <code>e</code>.</td></tr>
               <tr><td><code>e.removeAttribute(<i>name</i>)</code></td><td>Supprime l'attribut <code><i>name</i></code> de l'élément <code>e</code>.</td></tr>
            </table>
        </block>
    </slide>

    <slide>
        <title>Accéder aux éléments</title>        
        
        <block title="Accès à des attributs spécifiques des éléments">
            <table>
                <tr><td>Propriété/méthode</td><td>Description</td></tr>
                <tr><td><code>e.id</code></td><td>Définit/renvoie l'identifiant de l'élément</td></tr>
                <tr><td><code>e.title</code></td><td>Définit/renvoie le titre associé à l'élément (attribut <code>title</code>)</td></tr>  
                <tr><td><code>e.className</code></td><td>Définit/renvoie les classes associées à l'élément  
                <tr><td><code>e.classList</code></td><td>Renvoie une liste des classes associées à l'élément. <br>
                    Applicable sur cette liste : <br> 
                    <code>length</code> propriété pour connaître la taille de la liste <br>
                    <code>add(name1, name2, ...)</code> pour ajouter des classes,<br> 
                    <code>remove(name1, name2, ...)</code> pour supprimer des classes,<br>
                    <code>item(i)</code> pour renvoyer le nom de la classe à l'indice <code>i</code> <br>
                    <code>includes(name)</code> pour tester si une classe est dans la liste,<br>
                    <code>toggle(name)</code> pour ajouter/supprimer la classe si elle est absente/présente dans la liste.</td></tr> 
                <tr><td><code>e.style</code></td><td>renvoie une map du style de l'élément (détaillé plus tard)</td></tr>
                <tr><td><code>e.dataset.XXX</code><br><code>e.dataset['XXX']</code></td><td rowspan="2">renvoie la valeur de l'attribut personnalisé <code>data-XXX</code></td></tr>
            </table>
        </block>
        
    </slide>
    
            
    <slide>
        <title>Modifier le DOM</title>        
            
        <block title="Créer des noeuds ou des éléments">
            <table>
                <tr><td>Propriété/méthode</td><td>Description</td></tr>
                <tr><td><code>document.createElement(tagName)</code></td><td>Créé un nouvel élément</td></tr>
                <tr><td><code>document.createTextNode(contenu)</code></td><td>Créé un nouveau noeud texte</td></tr>
                <tr><td><code>document.createComment(contenu)</code></td><td>Créé un nouveau noeud de commentaires</td></tr>
            </table>    
        </block>
        
        <block title="Modification de l'arbre DOM">
            <table>
                <tr><td>Propriété/méthode</td><td>Description</td></tr>
                <tr><td><code>n.insertBefore(new,c)</code></td><td>ajoute le noeud <code>new</code> juste avant le noeud <code>c</code> 
                    dans la liste d'enfants de <code>n</code></td></tr>
                <tr><td><code>n.appendChild(c)</code></td><td>ajoute le noeud <code>c</code> à la fin de la liste d'enfants de <code>n</code></td></tr>
                <tr><td><code>n.removeChild(c)</code></td><td>supprime le noeud <code>c</code> des enfants de <code>n</code></td></tr>
                <tr><td><code>n.replaceChild(new,old)</code></td><td>remplace le noeud <code>old</code> par le noeud <code>new</code>
                    dans les enfants de <code>n</code></td></tr>

            </table>
        </block>
        
    </slide>    
        
    <slide>
        <title>Liste de noeuds</title>        
            
        <block title="HTMLCollection vs. NodeList">
            <p>Différents types de structures enregistrant un ensemble de noeuds peuvent être rencontrées : </p>
            <ul>
                <li>des objets HTMLCollection (pour les collections <code>document.forms</code>, <code>document.images</code> 
                    ou via <code>getElementsByTagName(...)</code>, etc.) qui sont assimilés à des tableaux mais qui n'en sont pas, 
                    on ne peut donc pas utiliser les fonctions des tableaux (comme par exemple <code>pop()</code>). 
                </li>
                <li>des objets NodeList (pour certains résultats de recherches d'éléments avec <code>querySelectorAll(...)</code>, 
                    ou via des propriétés comme <code>childNodes</code>) qui sont des objets représentant une liste avec des 
                    méthodes spécifiques.</li>
            </ul>
        </block>
        
        <block title="Manipuler les collections et les listes de noeuds">
        <p>Petit récapitulatif des notations et/ou méthodes utiles pour accéder aux éléments de ces deux types de structure : </p>
            <table>
                <tr><td>Notation (HTMLCollection)</td><td>Propriété/méthode (HTMLCollection)</td><td>Description</td></tr>
                <tr><td><code>coll.length</code></td><td><code>list.length</code></td><td>Renvoie la taille de la liste.</td></tr>
                <tr><td><code>coll[<i>i</i>]</code></td><td><code>list.item(<i>i</i>)</code></td><td>Accès l'élément <code><i>i</i></code> de la liste.</td></tr>
            </table>
        </block>
        
    </slide>        
            
    <slide>
        <title>Placement et affichage des éléments</title>
        
        <block title="Propriétés/fonctions de placement/affichage">
            <table>
                <tr><td>Propriété/méthode</td><td>Description</td></tr>
                <!--<tr><td colspan="2"><i>Taille des éléments</i></td></tr>-->
                <tr><td><code>e.clientHeight/e.clientWidth</code></td><td>Renvoie la taille visible (hauteur/largeur en pixels) de l'élément, incluant les marges internes mais pas la bordure - read-only </td></tr>
                <tr><td><code>e.clientLeft/e.clientTop</code></td><td>Renvoie la taille (en pixels) de la bordure gauche/dessus de l'élément</td></tr>
                <!--<tr><td colspan="2"><i>Position des éléments des éléments</i></td></tr>-->
                <tr><td><code>e.offsetHeight/e.offsetWidth</code></td><td>Renvoie la taille (hauteur/largeur en pixels) de l'élément, incluant les marges internes, les bordures et la barres de défilement (mais pas les marges externes)</td></tr>
                <tr><td><code>e.offsetLeft/e.offsetTop</code></td><td>Renvoie la position (gauche/dessus) de l'élément, incluant la marge externe et la position par rapport à l'<code>offetParent</code>.</td></tr>
                <tr><td><code>e.offsetParent</code></td><td>Renvoie l'élément qui est le plus proche ancêtre en positionnement statique. </td></tr>
                <!--<tr><td colspan="2"><i>Scrolling</i></td></tr>-->
                <tr><td><code>e.scrollHeight/e.scrollWidth</code></td><td>Renvoie la taille totale (hauteur/largeur en pixels) de l'élément, incluant les marges internes, les bordures et la barres de défilement (mais pas les marges externes)</td></tr>
                <tr><td><code>e.scrollLeft/e.scrollTop</code></td><td>Renvoie le nombre de pixels de scroll interne d'un élément (horizontal/vertical).</td></tr>
                <tr><td><code>e.scrollIntoView()</code></td><td>Scrolle la fenêtre pour visualiser l'élément. </td>
            </table>
            
        </block>
        
        <p>La liste complète des propriétés des éléments du DOM est présentée ici : 
            <url>https://www.w3schools.com/jsref/dom_obj_all.asp</url></p>
        
    </slide>
            
    <subsection>Modification du style</subsection>
        
    <slide>
        <title>@ref{currentSubsection}</title>
        
        <block title="La propriété <code>style</code>">
        <p>Comme vu précédemment, la propriété <code>style</code> permet d'avoir accès et de modifier le style CSS qui
            s'applique sur un élément. </p>
        <p>Cette propriété ne donne pas accès au style calculé par la feuille de style ; elle donne un accès à l'attribut 
            <code>style</code> de l'élément HTML concerné. </p>
        <p>Contrairement à d'autres propriétés des éléments HTML, celle-ci est un objet indexé sur les propriétés de style
            (éventuellement renommées pour éviter les traits d'union). </p>
        </block>
        
        <block title="Exemple de modification de style">
            <div class="playground h30" data-href="./examples/jsStyle1.html" data-opened="js"></div>
        </block>
                    
    </slide>     
            
            
     <slide>
        <title>Modification du style</title>
        
        <block title="Quelques propriétés de styles fréquemment utilisées">
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>display</code></td><td>Format d'affichage (<code>block</code>/<code>inline</code>/<code>none</code>)</td></tr>
                <tr><td><code>top / left / bottom / right</code></td><td>Placement haut / gauche / bas / droite (positionnement relatif, absolu ou fixe)</td></tr>
                <tr><td><code>fontSize</code></td><td>Taille de la police</td></tr>
                <tr><td><code>background</code></td><td>Raccourci pour les propriétés CSS de fond de l'élément</td></tr>
                <tr><td><code>backgroundColor / backgroundImage</code></td><td>Composantes couleur/image du fond de l'élément</td></tr>
                <tr><td><code>color</code></td><td>Couleur de la police</td></tr>
                <tr><td><code>opacity</code></td><td>Opacité de l'élément</td></tr>
                <tr><td><code>textAlign</code></td><td>Alignement du texte dans l'élément</td></tr>
                <tr><td><code>visibility</code></td><td>Visibilité de l'élément (<code>hidden</code>/<code>visible</code>)</td></tr>     
            </table>            
            <p>Les valeurs de ces propriétés sont des chaînes de caractères qui correspondent au style CSS que l'on souhaite 
            appliquer. </p>
         </block>
        
         <p>Globalement, toutes les propriétés de styles sont modifiables par Javascript. L'ensemble des propriétés de 
             style existantes est résumé ici : <url>https://www.w3schools.com/jsref/dom_obj_style.asp</url></p>
         
    </slide>             
    
    <slide>
        <title>Propriétés/méthodes propres aux entités HTML spécifiques</title>        
            
        <block title="Un objet par entité HTML">
            <p>Toutes les entités HTML héritent de HTMLElement, mais les objets du DOM sont bien plus vastes, 
            présentant chacun des attributs correspondant à leurs attributs propres. </p>
            <p>Par exemple, une image (objet <code>Image</code>) possède des attributs <code>src</code>, 
            <code>width</code>, <code>height</code> etc. directement accessibles et modifiables par 
                Javascript. </p>
        </block>
        
        <block title="Exemple de propriétés propres à un objet">
            <div class="playground nocss h30" data-href="./examples/jsBrowser4.html" data-opened="js"></div>
        </block>
        
    </slide>

    <slide>
        <title>Propriétés/méthodes propres aux entités HTML spécifiques</title>        
            
        <block title="Validation de formulaires">
            <p>Il est possible d'utiliser Javascript pour valider les formulaires, ou récupérer des 
                valeurs des zones de formulaires lorsque l'on réalise des interfaces graphiques. <br>
                Les zones de formulaires possèdent ainsi des propriétés pratiques pour accéder à leurs
            valeurs.</p>
        </block>
        
        <block title="Propriétés/méthodes utiles des zones de formulaire">
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>value</code></td><td>Valeur de la zone de formulaire (celle qui sera envoyée quand le formulaire sera soumis).<br>
                    Applicable à tous les objets représentant une zone de saisie. </td></tr>
                <tr><td><code>checked</code></td><td>Booléen indiquant si la case à cocher/bouton radio est sélectionné</td></tr>
                <tr><td><code>selectedIndex</code></td><td>Indice de l'option sélectionnée dans la liste déroulante (<code>select</code>)</td></tr>     
                <tr><td><code>add()/remove()</code></td><td>Ajoute/supprime une option dans la liste déroulante (<code>select</code>)</td></tr>
                
            </table>            
        </block>
        
    </slide>
          
    <slide>
        <title>Propriétés/méthodes propres aux entités HTML spécifiques</title>        
            
        <block title="Validation de formulaires">
            <p>Il est possible d'utiliser Javascript pour valider les formulaires, ou récupérer des 
                valeurs des zones de formulaires lorsque l'on réalise des interfaces graphiques. </p>
            <p>Les zones de formulaires possèdent ainsi des propriétés pratiques pour accéder à leurs
            valeurs.</p>
        </block>
        
        <block title="Exemple d'objets et de propriétés associées">
            <div class="playground nocss h30" data-href="./examples/jsBrowser5.html" data-opened="js"></div>
        </block>
        
    </slide>

    
    <section>Browser Object Model et événements</section>

    <slide outline class="no-navigation section currentSection">
        <title>Plan du chapitre</title>
    </slide>

    <slide>
        <title>Browser Object Model</title>        
            
        <block title="Qu'est-ce que c'est ?">
            <p>Il s'agit d'un ensemble d'objets, de propriétés et de méthodes proposées par les navigateurs. </p>
            <p>Bien que non-standardisées, contrairement au DOM, tous les navigateurs sont alignés sur la
            définition de bon nombre de ceux-ci, qui sont regroupés sous l'appellation Browser Object Model. </p>
        </block>
        
        <block title="Objets du BOM">
            <p>Les objets concernés sont les suivants : </p>
            <table>
                <tr><td>Objet</td><td>Description</td></tr>
                <tr><td><code>window</code></td><td>la fenêtre de navigateur, dont il est possible de connaitre les 
                    dimensions, d'ouvrir une nouvelle fenêtre, etc.</td></tr>
                <tr><td><code>window.screen</code></td><td>objet fournissant des informations sur l'écran comme sa taille, les couleurs, 
                    etc.</td></tr>
                <tr><td><code>window.location</code></td><td>objet fournissant des informations sur l'url de la page (protocole, 
                    nom d'hôte, chemin d'accès, etc.).</td></tr>
                <tr><td><code>window.history</code></td><td>objet représentant l'historique de navigation de la page (permet d'aller en avant, en arrière, etc.) </td></tr>
                <tr><td><code>window.navigator</code></td><td>objet fournissant des informations sur le navigateur (OS, user-agent, etc.)</td></tr>
                <tr><td><code>document.cookie</code></td><td>le cookie de navigation associé au site</td></tr>
            </table>
        </block>
        
    </slide>    
            
    <slide>
        <title>Browser Object Model</title>        
            
        <block title="Qu'est-ce que c'est ?">
            <p>Il s'agit d'un ensemble d'objets, de propriétés et de méthodes proposées par les navigateurs. </p>
            <p>Bien que non-standardisées, contrairement au DOM, tous les navigateurs sont alignés sur la
            définition de bon nombre de ceux-ci, qui sont regroupés sous l'appellation Browser Object Model. </p>
        </block>
            
        <block title="Méthodes du BOM">
            <p>Les méthodes proposées par l'objet <code>window</code> sont les suivantes :</p>
            <table>
                <tr><td>Méthode</td><td>Description</td></tr>
                <tr><td><code>window.alert(...)</code></td><td>fenêtre popup permettant d'informer/alerter (bouton OK). </td></tr>
                <tr><td><code>window.confirm(...)</code></td><td>fenêtres popup permettant de confirmer (boutons Oui/Non). </td></tr>
                <tr><td><code>window.prompt(...)</code></td><td>fenêtres popup permettant de saisir (format texte). </td></tr>
                <tr><td><code>window.setTimeout(...)</code></td><td>fonctions de temporisation avec délai </td></tr>
                <tr><td><code>window.setInterval(...)</code></td><td>fonctions de temporisation récurrentes)</td></tr>
            </table>
        </block>
    </slide>

    <subsection>L'objet window</subsection>    
            
    <slide>
        <title>Browser Object Model</title>        
            
        <block title="Propriétés de l'objet window">
            <p>Outre les propriétés qui seront détaillées dans le reste de cette section, l'objet <code>window</code>
            présente, entre autres, les propriétés suivantes :</p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>document</code></td><td>L'objet Document contenu dans la page</td></tr>
                <tr><td><code>frameElement</code></td><td>L'iframe dans laquelle le document est inséré (<code>null</code> si aucun)</td></tr>
                <tr><td><code>frames</code></td><td>L'ensemble des <code>iframe</code> contenues dans la page</td></tr>
                <tr><td><code>innerHeight/innerWidth</code></td><td>Hauteur/largeur internes de la fenêtre (sans les barres d'outils et de scolling)</td></tr>
                <tr><td><code>length</code></td><td>Nombre d'iframe contenues dans la fenêtre</td></tr>
                <tr><td><code>name</code></td><td>Le nom de la fenêtre actuelle</td></tr>
                <tr><td><code>outerheight/outerWidth</code></td><td>Hauteur/largeur externes de la fenêtre (incluant les barres d'outils et de scrolling)</td></tr>                
                <tr><td><code>opener</code></td><td>Référence vers la fenêtre ayant ouvert la fenêtre courante (<code>null</code> si aucune)</td></tr>
                <tr><td><code>pageXOffset/pageYOffset</code></td><td>Nombre de pixels scrollés horizontalement/verticalement pour le document courant</td></tr>
                <tr><td><code>parent / self / top</code></td><td>Référence aux fenêtres parente/courante/conteneur</td></tr>
            </table>
        </block>
        
        <p>L'ensemble des propriétés est disponible à l'adresse : <url>https://www.w3schools.com/jsref/obj_window.asp</url></p>
        
    </slide>    
            
    <slide>
        <title>Browser Object Model</title>        
            
        <block title="Connaître la taille de la fenêtre">        
            <p>Tous les navigateurs n'implantent pas de façon équivalente certaines propriétés. 
            A titre d'exemple, sur Internet Explorer, la propriété <code>window.innerHeight</code>
            est à remplacer par <code>document.documentElement.clientHeight</code> ou 
            <code>document.body.clientHeight</code>. </p>
            
        </block>
        
        <block title="Une disjonction sinon rien">
            <p>Le code ci-dessous permet de déterminer la taille de l'écran, quelque soit le navigateur utilisé :</p>
            <code>
            <div class="playground nohtml nocss noiframe console h20" data-href="./examples/jsBrowser7.html" data-opened="js"></div>
        </code>
            <p>Il n'est pas rare d'utiliser de telles disjonctions pour pallier aux problèmes
            d'existence de fonctions ou de propriétés. La sémantique est la suivante : si la première 
            valeur existe, c'est elle qui est considérée, sinon c'est la suivante, sinon c'est 
            celle d'après, etc. </p>

        </block>
        
    </slide>
            
     
     <slide>
        <title>Browser Object Model</title>        
            
        <block title="L'objet window">        
            <div class="playground nohtml nocss noiframe console h50" data-href="./examples/jsBrowser6.html" data-opened="js"></div>
        </block>
    </slide>
            
            
    <subsubsection>L'objet window.screen</subsubsection>    
            
    <slide>
        <title>Browser Object Model - @ref{currentSubsubsection}</title>        
            
         <block title="L'objet screen">
            <p>L'objet <code>window.screen</code> fournit des informations sur l'écran sur lequel la page 
                est affichée. Il propose les propriétés suivantes :</p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>availHeight</code>/<code>availWidth</code></td><td>Hauteur/largeur de l'écran (sans la barre des tâches)</td></tr>
                <tr><td><code>colorDepth</code></td><td>profondeur de couleur (en bits/pixels - 1, 4, 8, 15, 16, 24, 32, 48)</td></tr>
                <tr><td><code>pixelDepth</code></td><td>profondeur de pixel (équivalent au précédent)</td></tr>
                <tr><td><code>height</code>/<code>width</code></td><td>Hauteur/largeur totale de l'écran</td></tr>
            </table>
        </block>
         <block title="Exemple sur l'objet screen">
            <div class="playground nohtml nocss noiframe console h20" data-href="./examples/jsBrowser8.html" data-opened="js"></div>
        </block>
        
    </slide>    
    
    <subsubsection>L'objet window.location</subsubsection>    
            
    <slide>
        <title>Browser Object Model - @ref{currentSubsubsection}</title>        
            
        <block title="L'objet location">
            <p>L'objet <code>window.location</code> permet d'analyser l'URL du document courant. 
                Il propose les propriétés suivantes :</p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>href</code></td><td>L'URL complète du document</td></tr>
                <tr><td><code>protocol</code></td><td>Le protocole de l'URL</td></tr>
                <tr><td><code>host</code></td><td>Le nom d'hôte et le numéro de port</td></tr>
                <tr><td><code>hostname</code></td><td>Le nom d'hôte</td></tr>
                <tr><td><code>port</code></td><td>Le numéro de port</td></tr>
                <tr><td><code>origin</code></td><td>Le protocole, le nom d'hôte et le numéro de port</td></tr>
                <tr><td><code>pathname</code></td><td>Le chemin d'accès dans l'URL</td></tr>
                <tr><td><code>search</code></td><td>La partie requète (après le <code>?</code>)</td></tr>
                <tr><td><code>hash</code></td><td>L'ancre ciblée (après le <code>#</code>)</td></tr>
            </table>
            <p>Ces propriétés sont en lecture et écriture (excepté <code>origin</code> qui est en lecture seule). </p>
        </block>
            
    </slide>    
            
   <slide>
        <title>Browser Object Model - @ref{currentSubsubsection}</title>        
            
        <block title="L'objet location">
            <p>L'objet <code>window.location</code> propose les méthodes suivantes :</p>
            <table>
                <tr><td>Méthodes</td><td>Description</td></tr>
                <tr><td><code>assign(newURL)</code></td><td>Charge le nouveau document à l'adresse <code>newURL</code>.</td></tr>
                <tr><td><code>reload()</code></td><td>Recharge le document courant</td>.</tr>
                <tr><td><code>replace(newURL)</code></td><td>Remplace le document actuel par <code>newURL</code>.</td></tr>
            </table>
            <p><code>assign</code> est différente de <code>replace</code> car cette dernière supprime la page précédente de l'historique
            (elle l'écrase), tandis que <code>assign</code> la page courante restera dans l'historique. </p>
        </block>
       
       <block title="L'objet location">
            <div class="playground nocss nojs h20" data-href="./examples/jsBrowser9.html" data-opened="html"></div>
       </block>
            
    </slide>    

    <subsubsection>L'objet window.history</subsubsection>    
            
    <slide>
        <title>Browser Object Model - @ref{currentSubsubsection}</title>        
  
        
        <block title="L'objet history">
            <p>L'objet <code>window.history</code> permet de gérer la navigation dans l'historique et propose 
                la propriété suivante :</p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>length</code></td><td>La taille de l'historique.</td></tr>
            </table>
            <p>L'objet <code>window.history</code> propose les méthodes suivantes :</p>
            <table>
                <tr><td>Méthodes</td><td>Description</td></tr>
                <tr><td><code>back()</code></td><td>Revient à la page précédente le l'historique. </td></tr>
                <tr><td><code>forward()</code></td><td>Va à la page suivante dans l'historique. </td></tr>
                <tr><td><code>go(url|n)</code></td><td>Se déplace de <code>n</code> pages dans l'historique ou vers la page ayant l'url. </td></tr>
            </table>
            
        </block>
        
    </slide>    

    <subsubsection>L'objet window.navigator</subsubsection>    
            
    <slide>
        <title>Browser Object Model - @ref{currentSubsubsection}</title>        
        <block title="L'objet navigator">
            <p>L'objet <code>window.navigator</code> propose les propriétés suivantes :</p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>appCodeName</code></td><td>Retourne le nom de code du navigateur</td></tr>
                <tr><td><code>appName</code></td><td>Retourne le nom du navigateur</td></tr>
                <tr><td><code>appVersion</code></td><td>Retourne le numéro de version du navigateur</td></tr>
                <tr><td><code>cookieEnabled</code></td><td>Détermine si les cookies sont activés dans le navigateur</td></tr>
                <tr><td><code>geolocation</code></td><td>Renvoie un objet Geolocation qui permet d'accéder à la postition de l'utilisateur (détaillé plus tard)</td></tr>
                <tr><td><code>language</code></td><td>Retourne le langage du navigateur.</td></tr>
                <tr><td><code>onLine</code></td><td>Détermine si le navigateur est en ligne (connecté à internet)</td></tr>
                <tr><td><code>platform</code></td><td>Retourne la plateforme pour laquelle le navigateur est compilé.</td></tr>
                <tr><td><code>product</code></td><td>Retourne le nom du moteur du navigateur.</td></tr>
                <tr><td><code>userAgent</code></td><td>Retourne l'entête user agent envoyé par le navigateur au serveur.</td></tr>
            </table>                   
        </block>
    </slide>
            
    <slide>
        <title>Browser Object Model - @ref{currentSubsubsection}</title>        
        <block title="Exemple avec l'objet navigator">
            <div class="playground nocss nohtml noiframe console h40" data-href="./examples/jsBrowser10.html" data-opened="js"></div>
        </block>
      </slide>        
            
    <slide>
        <title>alert, confirm, prompt, etc...</title>    
        
        <block title="Les fenêtres modales">
            <p>Il existe 3 types de fênetres modales : </p>
            <table>
                <tr><td>Méthode</td><td>Description</td></tr>
                <tr><td><code>window.alert(...)</code></td><td>fenêtre popup permettant d'informer/alerter (bouton OK). </td></tr>
                <tr><td><code>window.confirm(...)</code></td><td>fenêtres popup permettant de confirmer (boutons Oui/Non). </td></tr>
                <tr><td><code>window.prompt(...)</code></td><td>fenêtres popup permettant de saisir (format texte). </td></tr>
            </table>
        </block>
        
        <block title="Exemples avec alert, confirm, prompt">
            <div class="playground nocss h20" data-href="./examples/jsBrowser13.html" data-opened="js"></div>
        </block>
        
    </slide>    
        
    <slide>
        <title>Délais</title>    
        
        <block title="setTimeout vs. setInterval">
            <p>Deux méthodes permettent de mettre en oeuvre des temporisations qu'il est possible d'annuler. </p>
            <table>
                <tr><td>Méthode</td><td>Description</td></tr>
                <tr><td><code>window.setTimeout(<i>fonction</i>, <i>delai</i>)</code></td><td>fonctions de temporisation avec délai </td></tr>
                <tr><td><code>window.setInterval(<i>fonction</i>, <i>delai</i>)</code></td><td>fonctions de temporisation récurrentes</td></tr>
                <tr><td><code>window.clearTimeout(<i>id</i>)</code></td><td>annule la temporisation avec délai</td></tr>
                <tr><td><code>window.clearInterval(<i>id</i>)</code></td><td>annule la temporisation récurrente</td></tr>
            </table>
        </block>
        
        <block title="Exemples de temporisations">
            <div class="playground nocss h20" data-href="./examples/jsBrowser14.html" data-opened="js"></div>
        </block>
    </slide>    
        
        
    <subsection>L'objet document.cookie</subsection>    

    <slide>
        <title>Les cookies</title>
        
        <block title="Petite blague" style="width: auto;">
                <p>Quelle célèbre phrase est illustrée ci-dessous ?</p>
                <img src="./images/cookie.jpg" style="width: 65vh; margin: 0 auto;">
            </row>
        </block>
    </slide>    
            
    <slide>
        <title>Browser Object Model - @ref{currentSubsection}</title>        
        
        <block title="Garder des informations côté client">
            <p>Il est parfois utile de pouvoir enregistrer des informations côté client. </p>
            <p>Historiquement, c'est le mécanisme de cookie qui avait été proposé. Un cookie 
            est une chaine de caractères possédant une durée de vie. </p>
        </block>
        
        <block title="Concrètement">
            <p>La propriété <code>document.cookie</code> permet de définir un cookie. La valeur 
            doit avoir un format particulier. </p>
            <table>
                <tr><td>Instruction</td><td>Signification</td></tr>
                <tr>
                    <td><code>document.cookie = "qui=fred";</code></td>
                    <td>Enregistre le couple de valeurs. Le cookie sera détruit lorsque le navigateur sera fermé.</td>
                </tr>
                <tr>
                    <td><code>document.cookie = "qui=fred; expires=Sun, 31 Dec 2017 23:58:00 UTC";</code></td>
                    <td>Ajoute à l'instruction précédente que le cookie sera détruit à la date indiquée.</td>
                </tr>
                <tr>
                    <td><code>document.cookie = "qui=fred; expires=Sun, 31 Dec 2017 23:58:00 UTC; path=/";</code></td>
                    <td>Ajoute à l'instruction précédente la page à laquelle le cookie est associé.</td>
                </tr>
            </table>
        </block>
    </slide>
    
            
     <slide>
        <title>Browser Object Model - @ref{currentSubsection}</title>        
     
         <block title="Affectations multiples de document.cookie">
         <p>En cas d'affectations multiples, les anciens cookies ne sont pas supprimés ; le nouveau est ajouté aux cookies existants. 
             Il faut donc être prudent. </p>
         </block>
         
         <block title="Consulter et supprimer les cookies">
             <table>
                <tr><td>Instruction</td><td>Signification</td></tr>
                 <tr>
                    <td><code>var cook = document.cookie;</code></td>
                    <td>Permet de lire le cookie dans la variable <code>cook</code> sous la forme d'une chaîne de caracères.</td>
                </tr>
                <tr>
                    <td><code>document.cookie = "qui=; expires=Thu, 1 Jan 1970 00:00:00 UTC; path=/"</code></td>
                    <td>Supprime le cookie en lui passant une date d'expiration antérieure à la date du jour.</td>
                </tr>
            </table>
        </block>
        
    </slide>    

             
     <slide>
        <title>Browser Object Model - @ref{currentSubsection}</title>        
     
         <block title="Exemples de manipulation de cookies">
            <div class="playground nocss h50" data-href="./examples/jsBrowser11.html" data-opened="js"></div>
            <p>Attention, sous Chrome, en local, les cookies ne sont pas disponibles.</p>
         </block>  
         
    </slide>         
            
    <subsection>Les objets storage</subsection>    
            
    <slide>
        <title>Browser Object Model - @ref{currentSubsection}</title>        
            
        <block title="Stocker des informations côté client">
            <p>Le navigateur n'a pas accès au système de fichier côté client. Avant HTML5, seuls les cookies 
            étaient possibles pour conserver de l'information. Or ceux-ci ne sont pas toujours efficaces 
            notamment en terme de gestion des informations enregistrées. </p>
            <p>HTML5 apporte des améliorations majeures en ce sens en proposant deux objets très pratiques :
            </p>
            <ul>
                <li><code>sessionStorage</code> : un objet permettant un stockage avec une durée de vie d'une session 
                    (la session se termine quand la fenêtre/l'onglet courant est fermé). </li>
                <li><code>localStorage</code> : un objet permettant un stockage avec une durée de vie illimitée. </li>
            </ul>
            <p>Ces deux types de stockage possèdent une taille maximale (5 Mo en général) et présentent une API 
            similaire. </p>
        </block>
        
        <block title="Des items au format clé=valeur">
        <p>Le format des données à enregistrer sera le classique <code>cle=valeur</code> où la valeur est une chaîne 
            de caractères. </p>
        <p>Si cela peut sembler limité à première vue, souvenez-vous que le format JSON pourrait être utilisé ici.</p>
        </block>
        
    </slide>    
            
        
    <slide>
        <title>Browser Object Model - @ref{currentSubsection}</title>        
            
        <block title="API des objets storage">
            <p>L'API des objets <code>localStorage</code> et <code>sessionStorage</code> propose la propriété suivante : </p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>length</code></td><td>Renvoie le nombre d'items présents dans le stockage.</td></tr>
            </table>        
            <p>La manipulation des items des <code>localStorage</code> et <code>sessionStorage</code> est réalisée au travers
                des méthodes suivantes : </p>
            <table>
                <tr><td>Méthodes</td><td>Description</td></tr>
                <tr><td><code>key(n)</code></td><td>Renvoie la clé à l'indice <code>n</code> du stockage.</td></tr>
                <tr><td><code>getItem(cle)</code></td><td>Renvoie la valeur associée à la clé passée en paramètre</td></tr>
                <tr><td><code>setItem(cle,valeur)</code></td><td>Ajoute l'item avec le couple clé-valeur donné en paramètre.</td></tr>
                <tr><td><code>removeItem(cle)</code></td><td>Supprimer l'item de la clé donnée en paramètre.</td></tr>
                <tr><td><code>clear()</code></td><td>Supprime tous les items.</td></tr>
            </table>        
        </block>
        
    </slide>    
        
    <slide>
        <title>Browser Object Model - @ref{currentSubsection}</title>        
            
        <block title="Exemples avec <code>localStorage</code>">
            <div class="playground nocss h50" data-href="./examples/jsBrowser12.html" data-opened="js"></div>
        </block>
        
    </slide>    

    <slide>
        <title>Browser Object Model - @ref{currentSubsection}</title>        
            
        <block title="Exemples avec <code>sessionStorage</code>">
            <div class="playground nocss h50" data-href="./examples/jsBrowser12bis.html" data-opened="js"></div>
        </block>
        
    </slide>    
            
            
    <slide>
        <title>Browser Object Model</title>        
            
        <block title="Les polyfills ou prothèses d'émulation">
        <p>Certains navigateurs proposent des méthodes standardisées, bien utiles, mais qui ne sont pas 
            forcément disponibles dans tous les navigateurs. Pour pallier ce problème, on définit des 
            polyfills (également appelées en français "prothèses d'émulation") qui sont des fonctions 
            visant à fournir un service standardisé quelque soit le navigateur. 
        </p>        
        </block>  
        
        <block title="Polyfill célèbre chez les développeurs de jeux en Web">
            <p>La fonction <code>requestAnimationFrame(function)</code> permet de réaliser un pré-calcul
            de l'exécution de la fonction en paramètre (utile pour pré-calculer des animations, comme 
                dans le double-buffering). </p>
            <p>Cette fonction n'existe pas forcément dans tous les navigateurs, 
            ou pas avec ce nom (souvent avec un préfixe-vendeur). Pour pallier ce problème, on développe 
                le polyfill suivant. </p>
            <code>var requestAnimationFrame = window.requestAnimationFrame<br>
                || window.webkitRequestAnimationFrame<br>
                || window.mozRequestAnimationFrame<br>
                || window.msRequestAnimationFrame<br>
                || function(callback) { return setTimeout(callback, 1000 / 60); };</code>
        </block>
        
    </slide>    
            
    <subsection>Les événements</subsection>        
            
    <slide>
        <title>Les événements</title>        
            
        <block title="Qu'est-ce que c'est ?">
        <p>Par définition, un événement est "quelque chose" qui se produit au sein du navigateur, et qui va être 
            observé et remonté pour pouvoir réagir. </p>
        <p>Les événements peuvent avoir diverses origines : </p>
        <ul>
            <li>des stimuli utilisateur : clic de souris, survol d'un élément, appui sur une touche du clavier, scroll de la page, 
                mise du focus sur un zone de saisie, etc. </li>    
            <li>des événements internes au navigateur : chargement de la page, d'une image, d'un script, modification du DOM, etc. </li>    
            <li>des événements internes au code Javascript : réception d'un message, retour d'appel d'une fonction asynchrone, etc. </li>    
            <li>des événements personnalisés, définis par l'utilisateur</li>
        </ul>
        <p>A part dans ce dernier cas, les événements sont déclenchés automatiquement par le navigateur, de façon complètement 
            transparente pour l'utilisateur. </p>
        </block>
        
    </slide>        
    
    <slide>
        <title>Les différents types d'événements existants</title>        

       
        
        <block title="Les différents types d'événements">
            <p>Il existe différents types d'événements : </p>
            <ul>
                <li>des événements souris : <code>click</code>, <code>dblclick</code>, <code>contextmenu</code>, <code>mousedown</code>, <code>mousenter</code>,<code>mousemove</code>, <code>mouseout</code>, <code>mouseover</code>, etc. </li>
                <li>des événements clavier : <code>keydown</code>, <code>keypress</code>, <code>keyup</code></li>
                <li>des événements sur les objets/fenêtres: <code>load</code>, <code>scroll</code>, <code>error</code>, <code>unload</code>, etc.</li>
                <li>des événements sur les formulaires : <code>change</code>, <code>focus</code>, <code>submit</code>, <code>reset</code>, etc.</li>
                <li>des événements de glisser-déposer : <code>drag</code>, <code>dragstart</code>, <code>dragend</code>, <code>drop</code>, etc.</li>
                <li>des événements média : <code>loadeddata</code>, <code>play</code>, <code>error</code>, etc.</li>
                <li>des événements génériques : <code>message</code>, <code>online</code>, <code>storage</code>, etc.</li>
                <li>des événements tactile : <code>touchstart</code>, <code>touchend</code>, <code>touchmove</code>, etc.</li>
            </ul>
            <p>Chaque type d'événement est décrit par un objet spécifique, qui possède des propriétés globales et des 
            propriétés propres au type d'événement considéré. </p>
        </block>
        
        <p>La référence complète des événements existants : <url>https://www.w3schools.com/jsref/dom_obj_event.asp</url></p>
        
    </slide>        
    
        
    <slide>
        <title>Réagir aux événements</title>    
        
         <block title="Associer un EventListener">
        <p>Javascript permet de réagir aux différents événements qui peuvent avoir lieu, en associant du code à 
            un événement par l'intermédiaire d'un <i>écouteur d'événement</i> (objet <code>EventListener</code>). </p>
        <p>Ces derniers peuvent être directement déclarés dans les éléments HTML (par exemple avec l'attribut <code>onclick</code>)
            ou être attachés aux entités HTML dans le code Javascript. </p>
        </block>
        
        <block title="Associer un événement par un attribut">
            <div class="playground nocss nojs h30" data-href="./examples/jsEvents1.html" data-opened="html"></div>
        </block>
        
    </slide>   
        
        
   <slide>
        <title>Réagir aux événements</title>    
        
        <block title="Associer un EventListener">
        <p>La seconde solution pour programmer la réaction à un événement est d'associer un écouteur d'événement à un 
            objet ou une entité HTML. </p>
        <p>Ceci se fait par l'intermédiaire de la méthode <code>addEventListener(<i>type</i>, <i>fonction</i>, <i>capture</i>)</code>, 
            portée par les entités HTML, dans laquelle :</p>
        <ul>
            <li><code><i>type</i></code> est une chaîne de caractère désignant le type d'événement considéré (par exemple <code>click</code>)
            </li>
            <li><code><i>fonction</i></code> est la fonction (nommée ou anonyme) décrivant le code qui sera exécuté en réaction à 
            l'événement. Cette fonction admet un paramètre représentant l'événement auquel on répond. </li>
            <li><code><i>capture</i></code> est un booléen optionnel indiquant si l'événement est reconnu dans la phase de capturing (<code>true</code>) ou dans la phase de bubbling (<code>false</code>). </li>
        </ul>
        <p>A noter qu'il est possible d'associer plusieurs écouteurs d'événements sur une même entité HTML (et pas forcément
            pour des événements différents). </p>
       </block>
   </slide>
        
    <slide>
        <title>Réagir aux événements</title>
        
        <block title="Mise en garde sur addActionListener">
            <p>Si vous souhaitez associer des écouteurs d'événements aux objets du DOM, il n'est possible de le faire 
            que lorsque celui-ci a fini de se charger (ce qui n'est pas le cas au sein de la balise <code>script</code>
            de l'entête). </p>
            <p>Pour pallier ce problème, on peut déclarer ces écouteurs d'événements lorsque le DOM a fini de se charger, 
            ce qui est signalé par... un événement (en l'occurrence <code>DOMContentLoaded</code>).</p>
        </block>
        
        <block title="Exemple de addActionListener">
            <div class="playground nocss h30" data-href="./examples/jsEvents2.html" data-opened="js"></div>
        </block>
        
    </slide>    
        
      <slide> 
        <title>La propagation d'événements selon le W3C</title>
        
        <block title="3 phases dans la propagation des événements">
        <img src="images/event-diagram.jpg" style="float: right; height: 20vw; width: auto; margin-left: 1vw;">
        <p>Le W3C définit 3 phases de propagation d'un événement, qui s'appuie sur le DOM : </p>
        <ul>
            <li>la phase dite "capturing" durant laquelle l'événement démarre de l'élément le plus englobant (en général la fenêtre) et
            se propage en descendant dans l'arbre DOM jusqu'à l'élément ciblé. </li>
            <li>la phase dite "targeting" durant laquelle l'événement a atteint l'élément cible. </li>
            <li>la phase dite "bubbling" durant laquelle l'événement remonte dans le DOM jusqu'à l'élément le plus englobant. </li>
        </ul>
        </block>
        
    </slide>    
        
    <slide> 
        <title>La propagation d'événements selon le W3C</title>
        
        <block title="3 phases dans la propagation des événements">
        <ul>
            <li>la phase dite "capturing" durant laquelle l'événement démarre de l'élément le plus englobant (en général la fenêtre) et
            se propage en descendant dans l'arbre DOM jusqu'à l'élément ciblé. </li>
            <li>la phase dite "targeting" durant laquelle l'événement a atteint l'élément cible. </li>
            <li>la phase dite "bubbling" durant laquelle l'événement remonte dans le DOM jusqu'à l'élément le plus englobant. </li>
        </ul>
        </block>
        
        <block title="Exemple">
            <div class="playground nocss h30" data-href="./examples/jsEvents3.html" data-opened="js"></div>
        </block>
    </slide>       
            
        
    <slide>
        <title>Les objets événéments</title>    
        
        <block title="Propriétés communes aux événements">
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>cancelable</code></td><td>Indique si l'événement peut être annulé</td></tr>
                <tr><td><code>currentTarget</code></td><td>L'élément dont les écouteurs ont capturé l'événement</td></tr>
                <tr><td><code>eventPhase</code></td><td>La phase durant laquelle l'événement est évalué</td></tr>
                <tr><td><code>target</code></td><td>L'élément qui a déclenché l'événement</td></tr>
                <tr><td><code>type</code></td><td>Type de l'événement</td></tr>
            </table>
        </block>
        
        <block title="Méthodes communes aux événements">
            <table>
                <tr><td>Méthode</td><td>Description</td></tr>
                <tr><td><code>preventDefault()</code></td><td>Annule l'action par défaut associée à l'événement.</td></tr>
                <tr><td><code>stopPropagation()</code></td><td>Empêche la propagation de l'événement dans le flux d'événement courant.</td></tr>
                <tr><td><code>stopImmediatePropagation()</code></td><td>Empêche le déclenchement des autres écouteurs du même événement.</td></tr>
            </table>
        </block>
        
    </slide>   

        
    <slide>
        <title>Les objets événéments</title>    
        
        <block title="Propriétés utiles des événements souris">
            <p>Les événements souris sont générés par des clics ou des mouvements du pointeur de souris. </p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>clientX / clientY</code></td><td>Coordonnées du pointeur, relatif à la fenêtre courante.</td></tr>
                <tr><td><code>pageX / pageY</code></td><td>Coordonnées du pointeur, relavement au document. </td></tr>
                <tr><td><code>screenX / screenY</code></td><td>Coordonnées du pointeur, relatif à l'écran. </td></tr>
                <tr><td><code>altKey / ctrlKey / metaKey / shiftKey</code></td><td>Indique si la touche alt, control, shift était pressée</td></tr>
            </table>
        </block>
        
        <block title="Propriétés utiles des événements clavier">
            <p>Les événements clavier sont générés par des appuis sur une touche du clavier. </p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>charCode</code></td><td>Code unicode du caractère ayant déclenché l'événement keypress.</td></tr>
                <tr><td><code>keyCode</code></td><td>Code unicode du caractère ayant déclenché l'événement keypress/keyup/keydown.</td></tr>
                <tr><td><code>altKey / ctrlKey / metaKey / shiftKey</code></td><td>Indique si la touche alt, control, shift était pressée</td></tr>
            </table>
        </block>
        
    </slide>   
        
    <slide>
        <title>Evénements</title>    
        
        <block title="Exemple d'événements souris et clavier">
            <div class="playground nocss h40" data-href="./examples/jsEvents4.html" data-opened="js"></div>
        </block>
        
    </slide>    
    

    <slide>
        <title>Evénements personnalisés</title>
    
        <block title="Créez vos propres événements">
            <p>Il est possible de créer des événements existants (par exemple pour simuler un 
                clic sur un bouton), mais aussi des événements personnalisés. </p>
            <p>La syntaxe pour créer un événement est la suivante : <code>var e = new Event("NomDeLEvenement")</code></p>
        </block>

        <block title="L'objet CustomEvent">
            <p>Pour les événements personnalisés auxquels on souhaite raccrocher des propriétés particulières, 
            il existe un objet <code>CustomEvent</code> qui s'instancie avec en plus du nom, un objet contenant 
            une propriété <code>detail</code>, comme suit : <code>var e = new CustomEvent("Nom", { "detail": valeur })</code></p>
        </block>
        
        <block title="Déclencher des événements">
            <p>Javascript permet de déclencher des événements, personnalisés ou non. </p>
            <p>La syntaxe est la suivante : <code><i>element</i>.dispatchEvent(<i>e</i>)</code> </p>
        </block>
        
    </slide>
            
    <slide>
        <title>Evénements personnalisés</title>    
        
        <block title="Exemple d'événements personnalisés">
            <div class="playground nocss h40" data-href="./examples/jsEvents5.html" data-opened="js"></div>
        </block>
        
    </slide>    
            
    
    <section>Programmation asynchrone</section>
    
    <slide outline class="no-navigation currentSection section">
        <title>Plan du chapitre</title>        
    </slide>

    <subsection>AJAX</subsection>
     
    <slide>
        <title>AJAX</title>
            <block title="Qu'est-ce que c'est ?">
                <p>AJAX signifie Asynchronous Javascript And XML.</p>
                <p>Il ne s'agit pas d'un langage de programmation, mais d'une combinaison de techniques/technologies pour 
                permettre l'échange d'information entre un client et un serveur : </p>
                <img src="images/ajax.png" style="display: block; width: 45vw; float: right; margin-left: 2vh;">
                <ul>
                    <li>le navigateur envoie une demande d'information au serveur (par l'intermédiaire d'un objet XMLHttpRequest)</li>
                    <li>le serveur traite la demande et renvoie une réponse sous une forme structurée (JSON ou XML) ou pas (texte brut)</li>
                    <li>le navigateur reçoit la réponse et traite les informations reçues, éventuellement en mettant à jour le contenu de la page.</li>
                </ul>
                <p style="clear: both;">L'aspect asynchrone vient du fait que le navigateur n'est pas bloqué en attendant la réponse du serveur. Contrairement
                au chargement d'une nouvelle page (comme avec PHP par exemple), c'est le client qui met tout seul à jour son contenu, 
                et ce, sans interruption pour l'utilisateur (l'interrogation du serveur se fait en tâche de fond). </p>
            </block>
    </slide>

    <slide>
        <title>L'objet XMLHttpRequest</title>
        
        <block title="Créer un objet XMLHttpRequest">
        <p>Tous les navigateurs modernes possèdent un objet XMLHttpRequest, qu'il suffit d'instancier avec 
            un <code>new</code>. Les anciennes versions d'Internet Explorer (IE5/6) nécessitent quant à 
            elles une instanciation d'un objet ActiveX. </p>
        <p><code>var xhttp = (window.XMLHttpRequest) ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");</code></p>
        </block>
        
        <block title="Problèmes de &quot;cross-domain&quot;">
            <p>Pour des raisons de sécurité, les navigateurs modernes empêchent d'aller lire des fichiers depuis
            d'autres domaines que celui sur lequel est le site. En particulier, cela permet d'empêcher à ces objets
            d'aller lire sur le disque dur de l'utilisateur (pour envoyer des informations sensibles vers un site distant
            par exemple...). </p>
            <p>Par conséquent, tous les sites auxquels veulent accéder les objets XMLHttpRequest seront dans le
            même domaine que le site contenant le script. Exception faites de certains serveurs de données qui 
            acceptent volontairement les requêtes cross-domain (ex. <code>data.gouv.fr</code>).</p>
            <p>En particulier, certains exemples de cette partie peuvent ne pas fonctionner si vous utilisez 
            ce diaporama en local (par exemple, le protocole <code>file:///</code> n'est pas autorisé pour cet 
            objet avec Chrome/Opera/Safari, mais il l'est avec FireFox). </p>
        </block>
        
    </slide>
            
    <slide>
        <title>Apparté : Cross-Origin Ressource Sharing</title>        
            
        <block title="Qu'est-ce que c'est ?">
            <p>Il s'agit d'un mécanisme qui permet à un user-agent de demander une ressource qui ne serait 
            pas dans le même domaine qu'elle. </p>
            <p>Par exemple, si le navigateur demande une ressource d'un autre domaine, avec un autre protocole, 
            ou avec un autre port que ceux dont est issu le document d'origine. </p>
        </block>
        
        <block title="Mais on fait ça tout le temps !">
            <p>Il est fréquent, dans une page web, de faire référence à une ressource externe au site 
            (image, script, feuille de style, etc. - très fréquent quand on passe par un Content Delivery
            Network comme par exemple pour Bootstrap). </p>
        </block>
            
        <block title="Alors où est le problème ?">
            <p>Pour des raisons de sécurité, les navigateurs vont restreindre les requêtes <i>cross-origin</i>
            lorsque celles-ci sont initiées dans des scripts. </p>
            <p>Plus de détails à ce sujet : <url>https://developer.mozilla.org/fr/docs/HTTP/Access_control_CORS</url></p>
        </block>
            
    </slide>
    
                
    <slide>
        <title>L'objet XMLHttpRequest</title>    
        
        <p>L'objet XMLHttpRequest est un peu particulier, car il sera automatiquement renseigné/modifié par le navigateur
        lorsque celui-ci recevra des informations du serveur. </p>
        
        <block title="Les propriétés de l'objet XMLHttpRequest">
            <p>L'objet XMLHttpRequest présente les propriétés suivantes : </p>
             <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>readyState</code></td><td>Statut de l'objet : 0 : non initialisé, 1 : connexion avec le serveur 
                    établie, 2 : requête reçue, 3 : requête en cours de traitement, 4 : requête finie et réponse prête. </td></tr>
                <tr><td><code>onreadystatechange</code></td><td>Fonction à définir qui sera déclenchée quand la propriété <code>readyState</code> aura changé. </td></tr>
                <tr><td><code>status</code></td><td>Statut (code) d'une requête : 200 OK, 403 accès refusé, 404 non trouvé, etc.</td></tr>
                <tr><td><code>statusText</code></td><td>Le texte associé au code <code>status</code></td></tr>
                <tr><td><code>responseText</code></td><td>Chaîne représentant la réponse du serveur au format texte.</td></tr>
                <tr><td><code>responseXML</code></td><td>Objet XML représentant la réponse du serveur.</td></tr>
            </table>
        </block>
        
    </slide>    
        
        
     <slide>
        <title>L'objet XMLHttpRequest</title>    
        
        <block title="Les méthodes de l'objet XMLHttpRequest">
            <p>L'objet XMLHttpRequest présente les méthodes suivantes : </p>
             <table>
                <tr><td>Méthode</td><td>Description</td></tr>
                <tr><td><code>abort()</code></td><td>Annule la requête en cours. </td></tr>
                <tr><td><code>getAllResponseHeaders()</code></td><td>Retourne les entêtes de la réponse.</td></tr>
                <tr><td><code>getResponseHeader(<i>nom</i>)</code></td><td>Retourne les entêtes <code><i>nom</i></code> de la réponse.</td></tr>
                 <tr><td><code>open(<i>method</i>,</i><i>url</i>,</i><i>async</i>,</i><i>user</i>,</i><i>passwd</i>)</code></td>
                    <td>Spécifie la requête : <br>
                        <code><i>method</i></code> : le type de requête <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code><br>
                        <code><i>url</i></code> : l'url demandée<br>
                        <code><i>async</i></code> : asynchrone (<code>true</code>) ou synchrone (<code>false</code>)<br>
                        <code><i>user</i></code> : l'utilisateur (optionnel)<br>
                        <code><i>passwd</i></code> : le mot de passe associé (optionnel)
                    </td></tr>
                <tr><td><code>setRequestHeader(<i>label</i>, <i>valeur</i>)</code></td><td>Ajoute une paire <code><i>label</i></code>/<code><i>valeur</i></code> à l'entête de la requête</td></tr>
                <tr><td><code>send()</code></td><td>Envoie la requête GET (uniquement)</td></tr>
                <tr><td><code>send(parametres)</code></td><td>Envoie la requête avec les paramètres</td></tr>
            </table>
        </block>
        
    </slide>    
        
    <slide>
        <title>Utiliser l'objet XMLHttpRequest</title>
    
        <block title="Comment utiliser l'objet XMLHttpRequest">
            <p>Le procédé pour envoyer une requête AJAX est toujours le même : </p>
            <ul>
                <li>créer l'objet <code>XMLHttpRequest</code></li>
                <li>le paramétrer : définir la méthode, l'url, s'il est synchrone (méthode <code>open</code>)</li>
                <li>définir le comportement attendu lors de réception de la réponse avec la propriété <code>onreadystatechange</code> : <br>
                    Attention la réponse n'est pas toujours positive ; il faut vérifier le <code>status</code>. <br> Par ailleurs, 
                cette fonction sera exécutée à chaque changement de valeur de <code>readyState</code>, il faut donc vérifier 
                que la réponse a été reçue (<code>readyState == 4</code>) <br>
                Le traitement réalisé pourra s'appuyer soit sur la valeur texte de la réponse (<code>responseText</code>) soit 
                sur l'objet <code>responseXML</code> pour lequel des fonctions de parcours sont disponibles. </li>
                <li>envoyer la requête avec la commande appropriée (<code>send()</code> pour une requête de type GET, 
                    ou <code>send(...)</code> pour une requête de type POST. </li>
            </ul>
            <p>Il est recommandé de toujours spécifier la requête comme asynchrone, pour éviter de bloquer l'exécution du 
            script en attente de la réponse du serveur (qui pourrait arriver très tardivement...) </p>
        </block>
        
    </slide>
    
    <slide>
        <title>Utiliser l'objet XMLHttpRequest</title>

        <block title="Utiliser l'objet XMLHttpRequest pour lire un fichier texte">
            <a href="./examples/ajaxExample.txt" target="_blank">Voir le fichier texte</a>
            <div class="playground nocss h50" data-href="./examples/jsAjax2.html" data-opened="js"></div>
        </block>

    </slide>


    <slide>
        <title>Utiliser l'objet XMLHttpRequest</title>

        <block title="Utiliser l'objet XMLHttpRequest pour lire un fichier JSON">
            <a href="./examples/ajaxExample.json" target="_blank">Voir le fichier JSON</a>
            <div class="playground nocss h50" data-href="./examples/jsAjax3.html" data-opened="js"></div>
        </block>

    </slide>

    <slide>
        <title>Utiliser l'objet XMLHttpRequest</title>

        <block title="Utiliser l'objet XMLHttpRequest pour lire un fichier XML">
            <a href="./examples/ajaxExample.xml" target="_blank">Voir le fichier XML</a>
            <div class="playground nocss h50" data-href="./examples/jsAjax4.html" data-opened="js"></div>
        </block>

    </slide>
    
    <slide>
        <title>Utiliser l'objet XMLHttpRequest</title>

        <block title="Utiliser l'objet XMLHttpRequest pour lire un fichier JSON depuis un serveur en open access">
            <p>Récupération de la liste des stations de tram de Besancon depuis l'<a href="https://api.ginko.voyage" target="_blank">API de Ginko</a>, 
                et parsing de la <a href="https://api.ginko.voyage/DR/getDetailsVariante.do?apiKey=XXX&idLigne=101&idVariante=15-0" target="_blank">réponse</a>. </p>
            <div class="playground nocss h50" data-href="./examples/jsAjax1.html" data-opened="js"></div>
        </block>

    </slide>


    <subsection>Fonctionnement de Javascript</subsection>

    <slide outline class="no-navigation section currentSection currentSubsection">
        <title>Plan du chapitre</title>
    </slide>

    <slide>
        <title>Fonctionnement de Javascript</title>
        
        <p>Le moteur Javascript a pour tâche d'interpréter le code Javascript contenu dans les scripts d'une page ou 
        dans un fichier JS.</p>
        
        <block title="Schéma du moteur Javscript">
            
        <row>
            <div>
            <p>Le moteur d'exécution peut se symboliser ainsi (vue très simplifiée) : </p>
            <ul>
                <li>La <strong>pile d'appel</strong> (stack), une pile de <i>cadres</i> des appels de fonctions 
                (chaque cadre contenant les paramètres de la fonction et les variables locales à celle-ci). </li>    
                <li>Le <strong>tas</strong> (heap), une zone mémoire contenant les objets créés en mémoire</li>
                <li>La <strong>file</strong> (queue), une file d'attente de messages à traiter ; ces messages 
                sont des appels de fonction, traités lorsque la pile est vide ou possède suffisamment d'espace. </li>
            </ul>
                </div>
            <img src="images/modele-memoire-js.svg" style="height: 30vh; width: auto;">
        </row>
            
        </block>
        
        <p>Source : <url>https://developer.mozilla.org/fr/docs/Web/JavaScript/Concurrence_et_boucle_des_%C3%A9v%C3%A9nements#Repr%C3%A9sentation_visuelle</url></p>
    </slide>
        
    <slide>
        <title>Fonctionnement de Javascript</title>
        
        <block title="La file de messages">
        
            <p>Basiquement, la gestion de la file de message ressemble à ceci : <br>
            <code>while (file.attendreMessage()) {<br>&nbsp;&nbsp;file.traiterMessage();<br>}</code>
            </p>
        
        </block>
                
        <block title="Javascript est mono-thread">
            <p>Chaque message est traité dans son intégralité, et il n'est pas possible 
            d'observer l'exécution d'un autre code qui prendrait le pas sur celui en cours 
            d'exécution (différent du C). </p>
            <p><strong>Avantage : </strong> meilleur contrôle du code qui s'exécute (pas 
            de mauvaises surprises)</p>
            <p><strong>Inconvénient :</strong> si un message met trop de temps à s'exécuter
            le navigateur se bloque (message <i>"Le script met trop de temps à répondre"</i>)
            et les interactions avec l'utilisateur ne sont plus traitées...</p>
        </block>
        
    </slide>
        
    <slide>
        <title>Fonctionnement de Javascript</title>

        
        <block title="Ajout de messages dans la file">
            <p>Deux types de messages peuvent être ajoutés à la file : </p>
            <ul>
                <li>des messages répondant à des événements : clic utilisateur, fin de chargement 
                d'une ressources (bref, les entrées/sorties) </li>
                <li>des timeouts : qui précisent la fonction à appeler (1er argument), et le nombre
                de millisecondes avant que la fonction ne soit ajoutée à la file (2e argument). </li>
            </ul>
        </block>
        
        <block title="Non-bloquant">
        
          <p>Javascript est considéré comme non-bloquant les entrées-sorties (chargements de 
              ressources, appels à des ressources externes) sont gérées par des événements 
              (<code>onload</code>, <code>onreadystatechange,etc.)</code>, et des callbacks 
              associés.</p>
            
        <p>Toutefois, on fera exception des <i>alertes</i> (<code>alert</code>, <code>confirm</code>, 
            <code>prompt</code>) ou des appels XHR synchrones (à éviter donc). </p>
            
        </block>
        
    </slide>
            
    <slide>
        <title>Chargement et exécution d'un script</title>

        <block title="Comportement de la balise <code>script</code>">
            
        <p>Par défaut, quand on charge un script avec la balise <code>&lt;script src="...">&lt;/script></code>, 
            le nagivateur s'interrompt dans la construction du rendu du document pour charger le script puis l'exécuter. </p>
        
        <img src="./images/script.png" style="width: 60%;">

        </block>
        
        
        <block title="Un chargement bloquant...">
            
            <p>Ceci a plusieurs conséquences : </p>
        
            <ul>
                <li>la construction de la page (le DOM) peut être interrompu longtemps si le script est long à charger 
                    ou à exécuter (pas sympa pour le visiteur). </li>
                <li>le script n'a potentiellement pas accès au DOM puisque celui-ci n'est pas encore construit ; il est donc 
                    souvent nécessaire d'attendre le déclenchement de l'événement <code>DOMContentLoaded</code> pour pouvoir
                    accéder au DOM et le modifier. </li>
            </ul>

        </block>
        
        <p>Une solution est de déplacer le chargement du script à la fin du marqueur <code>body</code>, mais ce n'est pas
        très propre...</p>
        
    </slide>

    <slide>
        <title>Chargement non-bloquant</title>
        <p>Depuis 2017, les navigateurs proposent des façons élégantes de résoudre ce problème, avec les deux attributs
        booléens <code>defer</code> et <code>async</code> qui se déclarent dans la balise de chargement du script 
        considéré. </p>
        
        <p>Leur but commun est de ne pas bloquer la construction de la page. </p>
        
        <p>Leur différence réside dans le moment où le script, une fois chargé, sera exécuté. </p>
</slide>
    
    <slide>
        <title>Chargement non-bloquant</title>
        <block title="L'attribut <code>defer</code>">
            <p>L'attribut <code>defer</code> indique, pour un script externe, que celui-ci doit être chargé en tâche de
                fond pendant que le reste de la page est interprété. </p>
            <p>Quand le script est chargé, son exécution est différée à la fin de construction du DOM 
                (juste avant le déclenchement de l'événement <code>DOMContentLoaded</code>). </p>
            <p>Si plusieurs scripts ont l'attribut <code>defer</code>, ils sont exécutés dans l'ordre dans lequel
            ils ont été déclarés. </p>
            <img src="images/script-defer.png" style="width: 55%;">
        </block>
</slide>

    <slide>
        <title>Chargement non-bloquant</title>

        <block title="L'attribut <code>async</code>">
            <p>L'attribut <code>async</code> indique, pour un script externe ou interne, que celui-ci doit être chargé 
                en tâche de fond pendant que le reste de la page est interprété. </p>
            <p>Quand le script est chargé, son exécution est immédiate, peu importe l'état d'avancement de l'interprétation 
                de la page (et la construction du DOM). </p>
            <p>Si plusieurs scripts ont l'attribut <code>async</code>, ils sont chargés en parallèle et exécutés dans 
                l'ordre où ils ont fini de charger (premier chargé, premier exécuté). </p>
            <img src="images/script-async.png" style="width: 55%;">
        </block>
        
    </slide>


    <subsection>Les Web Workers</subsection>
        
    
    <slide outline class="no-navigation section currentSection currentSubsection">
        <title>Plan du chapitre</title>
    </slide>
        
    <slide>
        <title>Les Web Workers</title>    
        
        <block title="Qu'est-ce que c'est ?">
            <p>Un web worker est un script qui s'exécute en arrière-plan, sans diminuer les performances de la page principale. </p>
            <p>Concrètement, il s'agit d'une classe <code>Worker</code> qui s'instancie avec un fichier de script. <br>
            <code>var workr = new Worker("monWorker.js");</code></p>
            <p>Habituellement, on met dans le code du worker un code qui pourrait être bloquant (forte charge CPU).</p>
        </block>
        
        <block title="Vérifier la compatibilité">
            <p>Pour vérifier l'existence des workers dans le navigateur, on évalue la condition <code>typeof(Worker) !== undefined</code></p>
            <div class="playground nocss nohtml h30" data-href="./examples/jsWorker1.html" data-opened="js"></div>
        </block>
        
    </slide>
        
    <slide>
        <title>Les Web Workers</title>
        
        <block title="Communication avec le script appelant">
            <p>Il est possible de faire communiquer deux environnements d'exécution distincts en utilisant un système 
            de passage de message avec la fonction <code>window.postMessage(<i>msg</i>)</code>. Cela fonctionne pour 
            les workers, mais aussi pour les <code>iframe</code>. </p>
            <p>L'environnement "cible" pourra écouter l'événement <code>onMessage</code> sur le worker et 
                implanter une fonction y répondant. </p>
        </block>

        
        <block title="Exemple de worker">
            <a href="examples/monWorker.js">Voir monWorker.js</a>
            <div class="playground nocss nohtml h30" data-href="./examples/jsWorker2.html" data-opened="js"></div>
        </block>
        
    </slide>    
        
    
    <subsection>Les promesses</subsection>
    
    <slide outline class="no-navigation section currentSection currentSubsection">
        <title>Plan du chapitre</title>
    </slide>
    
        
    <slide>
        <title>Une promesse, c'est quoi ?</title>
    
        <block title="Contexte des promesses">
            <p>Apparues avec ES2015, les promesses se placent dans un paradigme informatique assez connu, celui 
                du "producteur-consommateur"...</p>
            <ul>
                <li>le <strong>producteur</strong> est une portion de code qui va <i>produire</i> un résultat, ou 
                réaliser une action attendue</li>
                <li>le <strong>consommateur</strong> est une portion de code qui utilise (<i>consomme</i>) le résultat 
                    produit, ou nécessite une certaine action d'avoir été réalisée au préalable. </li>
            </ul>
            <p>Dans un environnement d'exécution synchrone, le producteur bloque jusqu'à avoir fini sa tâche, puis le 
            consommateur peut prendre le relais. </p>
        </block>
        
        <block title="... dans un contexte asynchrone !">
            <p>Certaines tâches sont obligatoirement réalisées de façon asynchrone par le moteur d'exécution 
                (notamment tout ce qui est chargement : d'images, de scripts, de contenu au sens large, ou les 
                appels AJAX, etc.)</p>
            <p>Javascript étant mono-thread et non-bloquant, "consommer" une ressource calculée de façon asynchrone
            n'est pas forcément simple...</p>
        </block>
    
        <p>Source de cette sous-section : <url>https://javascript.info/async</url></p>
        
    </slide>
    
    <slide>
        <title>Avant les promesses - les callbacks</title>    
        
        <p>Pour réaliser des traitements dans un environnement asynchrone, on utilise des callbacks déclenchés par des événements.</p> 
        
        <block title="Exemple de callback sans ordre">
            <div class="playground nocss h50" data-href="./examples/jsAsync1.html" data-opened="js"></div>
        </block>
        
    </slide>    
        
    
    <slide>
        <title>Avant les promesses - les callbacks</title>    
        
        <p>Avec parfois, des empilements en cascade...</p> 

        <block title="Exemple de callback avec ordonnancement">
            <div class="playground nocss h50" data-href="./examples/jsAsync2.html" data-opened="js"></div>
        </block>
        
    </slide>    
            
        
    <slide>
        <title>Avant les promesses - les callbacks</title>    
        
        <p>Et même en factorisant, ce n'est guère mieux...</p> 

        <block title="Exemple de callback avec ordonnancement">
            <div class="playground nocss h50" data-href="./examples/jsAsync2bis.html" data-opened="js"></div>
        </block>
        
    </slide>    
        
    <slide>
        <title>Et les promesses alors ?</title>    
        
        <block title="Qu'est ce qu'une promesse, concrêtement ?">
        <p>C'est un objet apparu avec ES2015 qui va permettre de gérer une valeur (ou un flux d'exécution) 
            en attente d'un calcul asynchrone, sans pour autant imbriquer des callback. </p>
        <p>L'objet <code>Promise</code> prend en paramètre une fonction qui admet deux paramètres :</p>
            <ul>
                <li><code>resolve(<i>value</i>)</code> qui est une fonction qui sera appelée lorsque le traitement 
                asynchrone aura terminé avec succès et à qui on passera la valeur calculée par ce traitement, </li>
                <li><code>reject(<i>error</i>)</code> qui est une fonction qui sera appelée lorsque le traitement 
                asynchrone échouera (à utiliser de préférence avec un objet <code>Error</code>).</li>
            </ul>
        <p>Le code de cette fonction (appelée <i>executor</i>) réalisera le traitement asynchrone et il devra faire un appel 
            à <code>resolve</code> quand celui-ci aura réussi et/ou <code>reject</code> quand celui-ci
            aura échoué (tout appel supplémentaire à l'une ou l'autre sera ignoré). </p>
        </block>
    </slide>
        
    <slide>
        <title>Les promesses - attributs </title>
        <block title="Etats d'une promesse">
            <p>L'objet <code>Promise</code> a deux attributs, internes (inaccessibles) : </p>
            <ul>
                <li><code>state</code> qui désigne l'état de la promesse (<code>pending</code>, puis 
                    <code>fulfilled</code> ou <code>rejected</code> en fonction de la terminaison de 
                    celle-ci. </li>
                <li><code>result</code> qui désigne soit la valeur de la promesse, une fois celle-ci résolue 
                (une valeur calculée), soit l'erreur générée si la promesse a été rejetée.</li>
            </ul>
        </block>
        
        <img src="images/promise-resolve-reject.png" class="figure" style="width: 50vh; height: auto;">
    </slide>    

    <slide>
        <title>Les promesses - méthodes </title>
        
        <block title="Et comment cela s'utilise-t-il ?">
            <p>Pour <i>consommer</i> le résultat du calcul réalisé par la promesse, on peut utiliser 
            deux méthodes offertes par celle-ci : </p>
            <ul>
                <li><code>.then(<i>function(result) {...}</i>, <i>function(error) {...}</i>)</code> où 
                <ul>
                    <li>le premier paramètre est une fonction qui s'exécute quand la promesse est résolue, et qui reçoit
                    le résultat de celle-ci, </li>
                    <li>le second paramètre est une fonction qui s'exécute si la promesse est rejetée et qui reçoit 
                    l'erreur ainsi générée.</li>
                </ul>
                Le second paramètre est optionnel.</li>
                <li><code>.catch(<i>function(error) {...}</i>)</code> qui est un raccourci pour <code>.then(null, <i>function(error) {...}</i>)</code>.
            </ul>
        </block>
    </slide>
                    
    <slide>
        <title>Les promesses - exemple d'utilisation</title>
        
        <block title="Exemple de promesse pour le chargement d'une image">
            <div class="playground nocss h50" data-href="./examples/jsAsync3.html" data-opened="js"></div>
        </block>
        
    </slide>
        
    <slide>
        <title>Les promesses - exemple d'utilisation</title>
        
        <block title="Exemple de promesse pour le chargement d'une image (avec fonction)">
            <div class="playground nocss h50" data-href="./examples/jsAsync3bis.html" data-opened="js"></div>
        </block>
        
    </slide>

    <slide>
        <title>Les promesses</title>

        <block title="Quelques éléments remarquables">
            <ul>
                <li>L'exécuteur peut effectuer un traitement synchrone, et renvoyer une valeur directement via 
                l'appel à la fonction <code>resolve</code>. 
                Toutefois, le resultat ne sera pas consommé avant le premier appel à <code>then</code>, même si
                    l'exécuteur est, lui, exécuté à la création de la promesse. </li>

                <li>Le premier argument de la méthode <code>then</code> d'une promesse renvoie une promesse. 
                Si cette méthode renvoie une autre valeur, celle-ci est automatiquement encapsulée dans une promesse.</li>

                <li>Les fonctions paramètres de <code>then</code> sont exécutés de façon asynchrone.</li>
            </ul>    
        </block>

        <block title="Démonstration !">
            <div class="playground nohtml nocss h25 noiframe console" data-href="./examples/jsAsync3ter.html" data-opened="js"></div>
        </block>
    </slide>

    <slide>
        <title>Des promesses, des promesses</title>
        
        <block title="Il est possible d'enchaîner les promesses !">
            <div class="playground nohtml nocss h50" data-href="./examples/jsAsync4.html" data-opened="js"></div>        
        </block>
        
    </slide>

    <slide>
        <title>Les mots-clés async et await</title>

        <p>Arrivés avec ES2016 ces fonctions permettent de contrôler l'asynchronisme. </p>
        
        <block title="Annoncer l'asynchronisme avec <code>async</code>">
            <p>Placé devant une déclaration de fonction, ce mot-clé signifie que la fonction retourne une promesse. </p>
            <p>Comme pour la méthode <code>then</code> vue précédemment, si le code ne retourne pas une promesse, Javascript
            s'occupera de l'encapsuler dans une promesse résolue avec la valeur de retour initialement définie.  </p>
        </block>
        
        <block title="Attendre l'asynchrone avec <code>await</code>">
            <p>Placé devant une promesse ce mot-clé permet de faire attendre l'exécution le temps que la promesse soit résolue. 
                Elle renverra la valeur de retour de la promesse résolue, ou déclenchera une erreur si la promesse a été rejetée. 
            </p>
            <p>Ce mot-clé ne s'utilise qu'à l'intérieur d'une fonction déclarée avec <code>async</code>. </p>
        </block>
        
    </slide>
    
    <slide>
        <title>Les mots-clés async et await</title>
        
        <block title="Exemple avec <code>async</code> et <code>await</code>">
            <div class="playground nocss h40" data-href="./examples/jsAsync5bis.html" data-opened="js"></div>        
        </block>
            
        <p>On notera que le mécanisme de <code>try/catch</code> permet de capturer une éventuelle erreur. </p>

    </slide>

    <slide>
        <title>Les mots-clés async et await</title>
        
        <block title="Retour à l'exemple">
            <div class="playground nocss h50" data-href="./examples/jsAsync5.html" data-opened="js"></div>        
        </block>        
        
    </slide>
    

    <slide>
        <title>La fonction fetch</title>    
        
        <block title="On peut oublier XMLHttpRequest">
            <p>La fonction <code>fetch(<i>url</i>)</code> (implantée dans l'objet <code>window</code> ou dans un worker) 
            permet d'aller récupérer une ressource via une url. </p>
            <p>Cette fonction renvoie une promesse qui contient la réponse (objet de type <code>Response</code>) à 
                la requête HTTP ainsi envoyée. </p>
            <p>Seule une erreur réseau empêche la promesse d'être résolue. Autrement, il faut vérifier la valeur du 
                <code>status</code> de l'objet <code>Response</code> renvoyé pour savoir si la ressource a bien été 
                trouvée (status 200). 
            </p>
        </block>
    </slide>

    <slide>
        <title>L'objet Response renvoyé</title>
        
        <block title="Quelques attributs (liste non-exhausive)">
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>headers</code></td><td>L'entête HTTP de la réponse. </td></tr>
                <tr><td><code>ok</code></td><td>Booléen indiquant si la réponse est un succès (status 2XX). </td></tr>
                <tr><td><code>status</code></td><td>Statut (code) de la réponse : 200 OK, 403 accès refusé, 404 non trouvé, etc.</td></tr>
                <tr><td><code>statusText</code></td><td>Le texte associé au code <code>status</code></td></tr>
                <tr><td><code>body</code></td><td>Le corps de la réponse.</td></tr>
            </table>            
        </block>
        
        <block title="Quelques méthodes (liste non-exhausive)">    
            <table>
                <tr><td>Méthode</td><td>Description</td></tr>
                <tr><td><code>json()</code></td><td>Renvoie une promesse qui se résoud sous forme d'un objet JSON. </td></tr>
                <tr><td><code>text()</code></td><td>Renvoie une promesse qui se résoud sous forme d'un texte.</td></tr>
            </table>            
        </block>
        
    </slide>

    <slide>
        <title>Exemple avec fetch</title>
        
        <block title="Un exemple avec <code>fetch</code>">
            <div class="playground nocss h50" data-href="./examples/jsFetch1.html" data-opened="js"></div>        
        </block>        
        
    </slide>
    


    <section>Quelques API utiles du navigateur</section>
        

    <slide outline class="no-navigation section currentSection currentSubsection">
        <title>Plan du chapitre</title>
    </slide>

    <subsection>Géolocalisation &amp; Lealfet/OpenStreetMap</subsection>        

    <slide>
        <title>Géolocalisation</title>
        
        <block title="Géolocaliser l'utilisateur">
            <p>La plupart des navigateurs proposent des API de géolocalisation. <br>
             Si vous êtes sur un PC de bureau ou un PC portable, c'est votre connexion internet 
            qui permettra de déterminer votre emplacement géographique (pas forcément ultra-précis). 
            Si vous êtes avec un appareil mobile, c'est le GPS qui prendra le relais. </p>
        </block>
        
        <block title="Attention, action utilisateur requise">
        <p>Pour des raisons de sécurité/confidentialité, l'accès à la position GPS de l'appareil 
            est sujette à approbation de l'utilisateur. Il faut donc prévoir une alternative dans
            vos applications si celui-ci n'accepte pas de donner accès à sa position. </p>
        </block>
        
    </slide>

    <slide>
        <title>Géolocalisation</title>
        
        <block title="Récupérer la position de l'utilisateur">
            <p>L'objet <code>window.geolocation</code> vous donne accès aux propriétés de géolocalisation
            de l'utilisateur. Celui-ci propose quelques méthodes utiles :</p>
            
            <table>
                <tr><td style="width: 40%;">Méthode</td><td>Description</td></tr>
                <tr><td><code>getCurrentPosition(<i>foncOK</i>, <i>foncKO</i>)</code></td><td>Récupère la position courante 
                    de l'utilisateur et la passe à la fonction <code><i>foncOK</i></code> passée en paramètre. Si la récupération 
                    échoue, appelle la fonction <code><i>foncKO</i></code>.</td></tr>
                <tr><td><code>watchPostion(<i>fonc</i>)</code></td><td>Même principe que la fonction précédente, 
                    mais en surveillant la position (à intervalles réguliers, à la manière d'un GPS). Renvoie 
                    un identifiant de la "surveillance". </td></tr>
                <tr><td><code>clearWatch(<i>id</i>)</code></td><td>Stoppe la surveillance passée en paramètre. </td></tr>
            </table>
            
        </block>
                
    </slide>

   <slide>
        <title>Géolocalisation</title>
        
        <block title="Les coordonnées de l'utilisateur">
            <p>La position de l'utilisateur est passée en paramètre aux fonctions de callback passées en paramètres
            de <code>getCurrentPosition(...)</code> et <code>watchPosition(...)</code>. Cet objet possède les 
            propriétés suivantes :</p>
            
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>timestamp</code></td><td>Le moment où la mesure a été effectuée.</td></tr>
                <tr><td><code>coords.latitude</code></td><td>La latitude en valeur décimale (toujours disponible).</td></tr>
                <tr><td><code>coords.longitude</code></td><td>La longitude en valeur décimale (toujours disponible).</td></tr>
                <tr><td><code>coords.accuracy</code></td><td>La précision de la mesure (toujours disponible).</td></tr>
                <tr><td><code>coords.altitude</code></td><td>L'altitude (si disponible).</td></tr>
                <tr><td><code>coords.altitudeAccuracy</code></td><td>La précision de l'altitude (si disponible).</td></tr>
                <tr><td><code>coords.heading</code></td><td>L'orientation en degrés à partir du nord (si disponible).</td></tr>
                <tr><td><code>coords.speed</code></td><td>La vitesse en mètres/seconde (si disponible).</td></tr>
            </table>
        </block>
                
    </slide>


   <slide>
        <title>Géolocalisation</title>
        
        <block title="Exemple de récupération des coordonnées de l'utilisateur">
            <div class="playground nocss h50 readonly" data-href="./examples/jsLeaflet1.html" data-opened="js"></div>
        </block>
                
    </slide>


   <slide>
        <title>L'API Leaflet</title>
        
        <block title="Qu'est-ce que c'est ?">
            <p>Leaflet est une bibliothèque JS libre de cartographie interactive en ligne, qui fonctionne à la manière de GoogleMaps. </p>
            <p>Leaflet en lui-même apporte la possibilité d'afficher des cartes, de zoomer, de marquer des points d'intérêts, etc. En général, 
            on couple Leaflet à une seconde API qui fournit les <i>tuiles</i> permettant de visualiser les cartes (plans, satellite, hybride, etc.).
            </p>
            <p>Nous allons nous intéresser ici à l'API de Leaflet, dans cette partie sur la géolocalisation.</p>
        </block>
       
       <block title="Clé d'accès">
        <p>Il n'est pas rare que les API fournies aux développeurs sur le web (Google, Twitter, Giphy, Ginko, etc.) 
            demandent à l'application/au développeur de posséder une <i>clé</i> pour accéder aux services proposés.
            Cela permet de connaître un peu la volumétrie de requètes effectuées vers l'API, à des fins de suivi et 
            de facturation (principalement). 
       </p>
        <p>Leaflet en tant que tel ne demande pas de clé. Il est possible d'utiliser le TileSet d'<a href="https://www.openstreetmap.org" target="_blank">OpenStreetMap</a>
           qui est lui aussi libre d'accès. Toutefois, vous pouvez trouver d'autres TileSets et d'autres services (calculs
           d'itinéraires, etc.) aurprès d'autres API qui vous demanderont une clé d'accès (comme par exemple <a href="https://www.mapbox.com/" target="_blank">MapBox</a>). </p>
       </block>
                
    </slide>

    <slide>
        <title>L'API Leaflet</title>

        <block title="Charger l'API Leaflet dans sa page">
            <p>L'intégration d'une carte Leaflet se fait en deux étapes.</p>
            <ul>
                <li>D'une part, il faut charger les scripts de l'API fournis par Leaflet (CSS d'abord, puis JS) dans l'entête du document. <br>
                <code>&lt;link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"<br>integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/&gt;</code>
                <br>
                <code>&lt;script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"<br>integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin="">&lt;/script></code>
                </li>
                <li>D'autre part, il faut initialiser la carte dans un bloc prévu à cet effet, avec du code JS. </li>
            </ul>
            <p>A noter que le chargement de l'API doit préférablement se faire en fin de document pour s'assurer 
            que le contenu de la page a été généré et peut-être référencé dans le script (ou s'appuyer sur les événements 
                type <code>DOMContentLoaded</code> ou <code>load</code>). </p>
        </block>     
    </slide>

    <slide>
        <title>Intégrer une carte Leaflet/OpenStreetMap</title>

        <block title="Initialiser ce que l'on veut voir sur la carte">
            <p>Plusieurs objets parmi <a href="https://leafletjs.com/reference-1.6.0.html" target="_blank">tous ceux proposés par l'API</a> seront particulièrement utiles : </p>
            <ul>
                <li>L'objet <code>Map</code> (instancié avec <code>L.map(bloc,options)</code>) 
                    qui permet de créer une carte dans le <code><i>bloc</i></code>, avec les <code><i>options</i></code>
                    correspondantes. </li>
                <li>L'objet <code>TileLayer</code> (instancié avec <code>L.tileLayer(tiles,options)</code>) 
                    qui permet de créer les tuiles permettant la visualisation de la carte à partir du fichier des tuiles <code>tiles</code>
                    et avec les options correspondantes. </li>
                <li>L'objet <code>Marker</code> (instancié avec <code>L.marker(options)</code>) 
                    qui permet d'ajouter à la surcouche un marqueur repérant un point particulier 
                    et permettant d'afficher des informations. </li>
            </ul>
        </block>
                        
    </slide>
            
    <slide>
        <title>Intégrer une carte Leaflet/OpenStreetMap</title>

        <block title="Carte centrée sur la Citadelle de Besançon">
            <div class="playground nocss h50 readonly" data-href="./examples/jsLeaflet2.html" data-opened="js"></div>
        </block>
                
    </slide>

    <slide>
        <title>Intégrer une carte Leaflet/OpenStreetMap</title>

        <block title="Les stations de bus de la ligne 9 récupérées en AJAX depuis l'API de Ginko Voyage">
            <div class="playground nocss h50 readonly" data-href="./examples/jsLeaflet3.html" data-opened="js"></div>
        </block>
                
    </slide>

    <slide>
        <title>Intégrer une carte Leaflet/OpenStreetMap</title>

        <block title="D'autres possibilités">
            <p>L'API de Leaflet et d'OpenStreetMap fournit tout un ensemble de possibilités :</p>
            <ul>
                <li>Ajouter d'autres surcouches sur la carte : polylignes, polygone, cercles, rectangles, fenêtre d'informations, etc.</li>
                <li>Répondre à des événements sur la carte : clic sur un marker, redimensionnement, scroll, </li>
                <li>Personnaliser les affichages des formes sur la carte</li>
                <li>Calculer des itinéraires, rechercher des points d'intérêts, etc. (plusieurs projets libres existent, tels que <a href="http://project-osrm.org" target="_blank">http://project-osrm.org</a> ou <a href="https://fr.open-street.com/doc/api">open-street.com</a>)</li>
                <li>En gros, tout ce que vous pouviez faire via l'interface web de GoogleMaps (avec quand même quelques restrictions)
                    mais sans Google... </li>
            </ul>
        </block>
                        
    </slide>


    <subsection>Le mobile</subsection>        
            
    <slide outline class="no-navigation section currentSection currentSubsection">
        <title>Plan du chapitre</title>
    </slide>

    <subsubsection>Touch Events</subsubsection>

    <slide>
        <title>Touch Events</title>
        
        <block title="Qu'est-ce que c'est ?">
            <p>Comme leur nom l'indique, les <i>touch events</i> sont les événements générés par l'appui sur une
            surface tactile (type tablette ou smartphone, ou certains écrans de PC). </p>
            <p>Pour faciliter la prise en charge de ces environnement d'exécution et en tirer le meilleur profit, 
            Javascript propose des API spécifiques. </p>
        </block>
        
        <block title="Evénements associés">
            <p>Les événements tactiles fonctionnement comme les événements vus précédemment (souris, clavier, etc.). 
            Ils s'attachent aux éléments du DOM que l'on souhaite. </p>
            <p>Ces événements sont les suivants : </p>
            <table>
                <tr><td>Evénement</td><td>Description</td></tr>
                <tr><td><code>touchstart</code></td><td>Début du contact sur la zone tactile (un doigt est ajouté).</tr>
                <tr><td><code>touchend</code></td><td>Fin du contact sur la zone tactile (un doigt est retiré).</tr>
                <tr><td><code>touchcancel</code></td><td>Sortie de la zone de surface tactile.</tr>
                <tr><td><code>touchmove</code></td><td>Déplacement sur la zone de la surface tactile.</tr>
            </table>
        </block>
        
    </slide>

    <slide>
        <title>Touch Events</title>
        
        <block title="Différence avec les autres types d'événements">
            <p>La différence principale avec les autres types d'événements réside dans le fait que 
                plusieurs points de contact simultanés peuvent être actifs. De ce fait, l'objet <code>TouchEvent</code>
            présente des propriétés permettant d'accéder à des listes d'objets <code>Touch</code>, encapsulés dansd
            des objets <code>TouchList</code>. </p>
       
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>altKey/crtlKey/metaKey/shiftKey</code></td><td>Indique si la touche alt/ctrl/meta/shift est appuyée.</td></tr>
                <tr><td><code>changedTouches</code></td><td><code>TouchList</code> des points de contact ayant changé. 
                    Dépend de l'événement :<br>
                    pour <code>touchstart</code> : points devenus actifs avec l'événement courant<br>
                    pour <code>touchmove</code> : points qui se sont déplacés<br>
                    pour <code>touchend</code> : points qui ne sont plus en contact avec la surface
                </td></tr>
                <tr><td><code>targetTouches</code></td><td><code>TouchList</code> des points qui sont en contact avec la surface et pour lesquels l'événement 
                    <code>touchstart</code> a eu lieu à l'intérieur du même élément que l'élément cible courant. </td></tr>
                <tr><td><code>touches</code></td><td><code>TouchList</code> de tous les points de contact avec la surface.</tr>
            </table>
        </block>
        
    </slide>

    <slide>
        <title>Touch Events</title>
        
        <block title="Objet <code>Touch</code>">
            <p>Cet objet représente un point de contact sur la surface tactile. </p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>identifier</code></td><td>Identifiant unique représentant un point de contact durant tout le temps 
                    du contact.</td></tr>
                <tr><td><code>screenX/screenY</code></td><td>Coordonnées du point de contact par rapport à l'écran.</td></tr>
                <tr><td><code>clientX/clientY</code></td><td>Coordonnées du point de contact par rapport à la fenêtre du navigateur.</td></tr>
                <tr><td><code>pageX/pageY</code></td><td>Coordonnées du point de contact par rapport à la page.</td></tr>
                <tr><td><code>target</code></td><td>L'élément sur lequel le point de contact a débuté. </td></tr>
            </table>
        </block>
  </slide>

    <slide>
        <title>Touch Events</title>
                
        <block title="Objet <code>TouchList</code>">
            <p>Cet objet représente une liste d'objet <code>Touch</code>, il présente les membres suivants : </p>
            <table>
                <tr><td>Propriété/méthode</td><td>Description</td></tr>
                <tr><td><code>length</code></td><td>Longueur de la liste.</td></tr>
                <tr><td><code>item(<i>i</i>)</code></td><td>Renvoie l'item à l'indice <code><i>i</i></code>.</td></tr>
            </table>
            <p>A noter que la notation <code>[<i>i</i>]</code> permet d'accéder aux éléments de la liste 
            comme si c'était un tableau. </p>
        </block>
        
        <p style="margin-top: 3vh;">L'API complète des événements <code>Touch</code> est disponible à l'adresse : 
            <url>https://developer.mozilla.org/en-US/docs/Web/API/Touch</url></p>
        
    </slide>

     
    <slide>
        <title>Touch Events</title>
        
        <block title="Démonstration des événements touch">
            <div class="playground nohtml nocss h50" data-href="./examples/jsEvents6.html" data-opened="js"></div>
        </block>
        
    </slide>


    <subsubsection>Device orientation</subsubsection>

    
    <slide>
        <title>Device orientation</title>
        
        <block title="Qu'est-ce que c'est ?">
            <p>Les appareils mobiles ont, pour la plupart, des fonctions de gyroscope et d'accéléromètre, 
            qu'il est possible d'interroger. L'événement déclenché est <code>deviceorientation</code>.</p>
        </block>
        
        <block title="Les propriétés de l'objet <code>DeviceOrientationEvent</code>">
        <p>Cet objet propose les propriétés (read-only) suivantes : </p>
        <img src="./images/device-axes.png" style="float: left; width: 25vw;">
        <table>
            <tr><td>Propriété</td><td>Description</td></tr>
            <tr><td><code>absolute</code></td><td>Booléen : <code>true</code> si les données sont présentées dans 
                le référentiel terrestre,<br><code>false</code> si les données utilisent un référentiel arbitraire.</td></tr>
            <tr><td><code>alpha</code></td><td>Mouvement autour de l'axe Z (entre 0 et 360 degrés)</td></tr>
            <tr><td><code>beta</code></td><td>Mouvement autour de l'axe X (entre -180 et +180 degré).<br>
                Représente le mouvement d'avant en arrière de l'appareil.</td></tr>
            <tr><td><code>gamma</code></td><td>Mouvement atour de l'axe Y (entre -90 et +90 degrés).<br>
                Représente le mouvement de gauche à droite de l'appareil.</td></tr>
        </table>
        </block>
        
    </slide>
    
    <slide>
        <title>Device orientation</title>
        
        <block title="Device orientation sans appareil mobile">
            <p>Les outils développeurs des navigateurs (en natif sur Chrome) permettent de simuler des changements 
                d'orientation. </p>
        </block>
        
        <block title="Détection de l'orientation">
            <div class="playground nohtml nocss h20" data-href="./examples/jsEvents7.html" data-opened="js"></div>
        </block>
    </slide>

    <subsubsection>Device motion</subsubsection>        
            
    <slide>
        <title>Device motion</title>
        
        <block title="L'objet DeviceMotionEvent">
            <p>Cet objet fournit des informations sur la vitesse de changement d'orientation et de position de l'appareil. 
                Il propose les propriétés (read-only) suivantes : </p>
            <table>
            <tr><td>Propriété</td><td>Description</td></tr>
            <tr><td><code>acceleration</code></td><td>Objet composite indicé par les 3 axes (x, y, z) représentant : 
                <br><code>x</code> : l'axe d'ouest en est
                <br><code>y</code> : l'axe sud vers nord
                <br><code>z</code> : l'axe perpendiculaire au sol</td></tr>
            <tr><td><code>accelerationIncludingGravity</code></td><td>Même information que pour le précédent, en prenant 
                en compte la gravité.</td></tr>
            <tr><td><code>rotationRate</code></td><td>Objet composite indicé par les 3 composantes (alpha, beta, gamma) représentant : 
                <br><code>alpha</code> : ratio de rotation le long de l'axe perpendiculaire à l'écran
                <br><code>beta</code> : ratio de rotation le long de l'axe allant de gauche à droite de l'écran
                <br><code>gamma</code> : ratio de rotation le long de l'axe allant du bas au haut de l'écran
            <tr><td><code>interval</code></td><td>L'intervalle de temps (en ms) entre deux mesures.</td></tr>
            </table>        
        </block>
        
        <p>Pour aller plus loin, vous pouvez vous référer à la référence de l'API : <url>https://developer.mozilla.org/en-US/docs/Web/API/DeviceMotionEvent</url> et <url>https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Orientation_and_motion_data_explained</url></p>

    </slide>

        
    <subsection>Dessiner dans les canvas</subsection>
    
    <slide outline class="no-navigation section currentSection currentSubsection">
        <title>Plan du chapitre</title>
    </slide>

    <slide>
        <title>Le canvas</title>    
        
        <block title="Qu'est-ce que c'est ?">
            <p>Le <code>canvas</code> est une entité HTML qui représente une zone de dessin. Un canvas permet de :</p>
            <ul>
                <li>dessiner/écrire du texte</li>
                <li>dessiner des formes simples : lignes, arcs, cercles, polyones, chemins, etc.</li>
                <li>afficher des images : en les redimensionnant, tout ou partie, etc.</li>
                <li>réaliser des animations : par cycles d'effacement/affichage successifs (60 fps) </li>
                <li>répondre à des interactions avec le clavier ou la souris par le biais d'écouteurs d'événements </li>
            </ul>
            <p>Bref, tout pour faire des jeux vidéos...</p>
        </block>
        
    </slide>
        
        
    <slide>
        <title>Le canvas</title>
        
        <block title="Dessiner dans le canvas">
            <p>L'objet <code>canvas</code> en lui-même ne porte pas de primitives de dessin. Pour ce faire, 
                il faut obtenir un contexte graphique, obtenu en appelant la méthode <code>getContext("2d")</code>
                qui renvoie un contexte en 2 dimensions. 
            </p>
            <p>Le contexte renvoyé possède deux axes X (axe horizontal) et Y (axe vertical). Classiquement en 
                informatique, le point de coordonnées <code>(0 ; 0)</code> correspond au coin supérieur gauche 
            de la zone de dessin, mais il peut être déplacé avec les primitives adéquates. </p>
        </block>
        
        <block title="Paths, Fill et Stroke (chemins, remplissage et contours)">
        <p>Comme dans beaucoup d'API de dessin, le canvas s'appuie sur la notion de chemin, qui permet de tracer 
            des lignes dans le plan. Une fois le chemin terminé, il est possible de le tracer (<code>stroke</code>)
            ou de le remplir (<code>fill</code>).</p>
        <p>Ces notions se retrouvent aussi pour le texte. </p>
        </block>
        
    </slide>
            
    <slide>
        <title>Le canvas</title>
        
        <block title="Paramètres de dessin/coloriage">
            <p>Les propriétés suivantes peuvent être consultées ou modifiées pour paramétrer le dessin :</p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>fillStyle</code></td><td>Spécifie ou renvoie le style utilisé pour le remplissage. </td></tr>
                <tr><td><code>strokeStyle</code></td><td>Spécifie ou renvoie le style utilisé pour le dessin du contour. </td></tr>
                <tr><td><code>shadowColor/shadowBlur</code></td><td>Spécifie ou renvoie la couleur/le flou utilisé pour les ombres. </td></tr>
                <tr><td><code>shadowOffsetX/shadowOffsetY</code></td><td>Spécifie ou renvoie le décalage pour l'ombre. </td></tr>
            </table>            
        </block>

        <block title="Paramètres de dessin/tracé">
            <p>Les propriétés suivantes peuvent être consultées ou modifiées pour paramétrer de tracé du dessin :</p>
            <table>
                <tr><td>Propriété</td><td>Description</td></tr>
                <tr><td><code>lineWidth</code></td><td>Spécifie ou renvoie la largeur de ligne. </td></tr>
                <tr><td><code>lineCap</code></td><td>Spécifie ou renvoie le style utilisé l'extrémité des lignes (<code>round</code>, <code>butt</code>, <code>square</code>). </td></tr>
                <tr><td><code>lineJoin</code></td><td>Spécifie ou renvoie le style utilisé les jointures entre segments (<code>round</code>, <code>bevel</code>, <code>miter</code>). </td></tr>
            </table>
            
        </block>

      </slide>
            
    <slide>
        <title>Le canvas</title>
          
        <block title="Ecrire du texte">
            <p>Avant d'écrire du texte, il est possible de spécifier diverses propriétés (font, couleur, etc.). Les 
            propriétés et méthodes utiles sont les suivantes :</p>
            <table>
                <tr><td>Propriété/méthode</td><td>Description</td></tr>
                <tr><td><code>font</code></td><td>Spécifie ou renvoie la police sous la forme d'une chaîne de caractères.<br>
                    Exemple : <code>"30px Helvetica"</code></td></tr>
                <tr><td><code>textAlign</code></td><td>Spécifie ou renvoie l'alignement du texte (<code>start</code>, 
                    <code>end</code>, <code>left</code>, <code>right</code>, <code>center</code>). </td></tr>
                <tr><td><code>textBaseline</code></td><td>Spécifie ou renvoie la ligne de base du texte (<code>top</code>, 
                    <code>bottom</code>, <code>alphabetic</code>, <code>middle</code>, <code>hanging</code>). </td></tr>
                <tr><td><code>fillText(txt, x, y)</code></td><td>Ecrit le texte aux coordonnées spécifiées en remplissant les caractères. </td></tr>
                <tr><td><code>strokeText(txt, x, y)</code></td><td>Ecrit le texte aux coordonnées spécifiées en dessinant le contour des caractères. </td></tr>
                <tr><td><code>measureText(txt)</code></td><td>Retourne un objet qui contient la taille du texte en paramètre. </td></tr>
            </table>
            
        </block>

    </slide>

    <slide>
        <title>Le canvas</title>    
        
        <block title="Un premier exemple de dessin de canvas">
            <div class="playground nocss h50" data-href="./examples/jsCanvas1.html" data-opened="js"></div>
        </block>
    </slide>    
        
        
    <slide>
        <title>Le canvas</title>
        
        <block title="Dessiner des rectangles">
            <p>Quelques méthodes permettent de dessiner ou d'effacer des rectangles :</p>
            <table>
                <tr><td style="width: 35%;">Méthode</td><td>Description</td></tr>
                <tr><td><code>fillRect(x, y, width, height)</code></td><td>Dessine et remplit un rectangle de la taille souhaitée à partir des coordonnées indiquées pour le coin supérieur gauche. </td></tr>
                <tr><td><code>strokeRect(x, y, width, height)</code></td><td>Dessine les contours d'un rectangle de la taille souhaitée à partir des coordonnées indiquées pour le coin supérieur gauche.  </td></tr>
                <tr><td><code>clearRect(x, y, width, height)</code></td><td>Efface un rectangle de la taille souhaitée à partir des coordonnées indiquées pour le coin supérieur gauche. Utile pour les animations... </td></tr>
            </table>
            
        </block>
        
    </slide>

    <slide>
        <title>Le canvas</title>
        
        <block title="Tracer des chemins">
            <p>Petit aperçu des propriétés proposées pour tracer des chemins :</p>
            <table>
                <tr><td style="width: 40%;">Méthode</td><td>Description</td></tr>
                <tr><td><code>beginPath()</code></td><td>Démarre un chemin à partir du point courant.</td></tr>
                <tr><td><code>moveTo(x,y)</code></td><td>Déplace le point courant (crayon) aux coordonnées indiquées.</td></tr>
                <tr><td><code>closePath()</code></td><td>Ferme le chemin en revenant au point de départ. </td></tr>
                <tr><td><code>lineTo(x,y)</code></td><td>Continue le chemin en traçant une ligne vers le point spécifié.</td></tr>
                <tr><td><code>arc(x, y, start, end)</code></td><td>Forme un arc de cercle au point spécifié, de l'angle <code>start</code>
                    à l'angle <code>end</code> (angles en radians)</td></tr>
                <tr><td><code>rect(x, y, width, height)</code></td><td>Forme un rectangle au point spécifié, de taille spécifiée.</td></tr>
                <tr><td><code>quadraticCurveTo(cpx, cpy, x, y)</code></td><td>Continue le chemin en effectuant une courbe de Bézier quadratique allant en (x,y) et guidée par (cpx, cpy).</td></tr>
                <tr><td><code>bezierCurveTo(cpx1, cpy1, cpx2, cpy2, x, y)</code></td><td>Continue le chemin en effectuant une courbe de Bézier allant en (x,y) et guidée par (cpx1, cpy1) et (cpx2, cpy2).</td></tr>
                <tr><td><code>fill()</code></td><td>Dessine le chemin et le remplit.</td></tr>
                <tr><td><code>stroke()</code></td><td>Dessine uniquement le tracé du chemin.</td></tr>
            </table>
        </block>
    </slide>
        
    <slide>
        <title>Le canvas</title>    
        
        <block title="Dessiner des chemins dans le canvas">
            <div class="playground nocss h50" data-href="./examples/jsCanvas2.html" data-opened="js"></div>
        </block>
    </slide>    
    
        
   <slide>
        <title>Le canvas</title>
        
        <block title="Transformations de repère">
            <p>Il est possible de changer le repère pour modifier les axes de dessin. </p>
            <table>
                <tr><td style="width: 40%;">Méthode</td><td>Description</td></tr>
                <tr><td><code>scale(scWidth, scHeight)</code></td><td>Mise à l'échelle des abscisses (scWidth) et des ordonnées (scHeight).</td></tr>
                <tr><td><code>rotate(angle)</code></td><td>Tourne le repère de l'angle spécifié (en radians).</td></tr>
                <tr><td><code>translate(x,y)</code></td><td>Déplace l'origine du repère.</td></tr>
                <tr><td><code>transform(a, b, c, d, e, f)</code></td><td>Multiple la matrice de transformation courante avec la matrice <br>
                    <table class="matrix" style="float: left; margin-right: 2vh;"><tr><td><code>a</code></td><td><code>c</code></td><td><code>e</code></td></tr><tr><td><code>b</code></td><td><code>d</code></td><td><code>f</code></td></tr><tr><td>0</td><td>0</td><td>1</td></tr></table><br><code>a</code> est la mise à l'échelle horizontale, <code>b</code> est l'inclinaison horizontale,<br><code>c</code> est l'inclinaison verticale, <code>d</code> est la mise à l'échelle verticale,<br><code>e</code> est le déplacement horizontal, <code>f</code> est le déplacement vertical. </td></tr>
                <tr><td><code>setTransform(a, b, c, d, e, f)</code></td><td>Réinitialise la matrice de transformation et applique la transformation en paramètre.</td></tr>
            </table>
       </block>
       
    </slide>    
    
        
   <slide>
       <title>Le canvas</title>
       <block title="Enregistrer / restaurer les propriétés du repère">
            <p>Pour ne pas se perdre dans des transformations successives et revenir rapidement au repère d'origine, les méthodes
            suivantes sont proposées : </p>
            <table>
                <tr><td>Méthode</td><td>Description</td></tr>
                <tr><td><code>save()</code></td><td>Enregistre (empile) le contexte actuel.</td></tr>
                <tr><td><code>restore()</code></td><td>Restaure (dépile) le contexte précédent enregistré.</td></tr>
            </table>
        </block>
        
        <block title="Transformations de repère">
            <div class="playground nocss h30" data-href="./examples/jsCanvas3.html" data-opened="js"></div>
        </block>
               
    </slide>    
     
        
   <slide>
        <title>Le canvas</title>
        
        <block title="Dessiner des images">
            <p>Pour manipuler des images, la méthode suivante est à utiliser : </p>
            <table>
                <tr><td>Méthode</td><td>Description</td></tr>
                <tr><td><code>drawImage(img, x, y)</code></td><td>Dessine l'image <code>img</code> aux coordonnées spécifiées.</td></tr>
                <tr><td><code>drawImage(img, x, y, width, height)</code></td><td>Dessine l'image <code>img</code> aux coordonnées spécifiées en le redimensionnant.</td></tr>
                <tr><td><code>drawImage(img, sx, sy, sWidth, sHeight, x, y, width, height)</code></td><td>Dessine la partie de l'image <code>img</code> de taille <code>sWidth</code> x <code>sHeight</code> démarrant en <code>(sx;sy)</code>, aux coordonnées spécifiées aux 
                dimensions <code>width</code> x <code>height</code>.</td></tr>
            </table>
        </block>
        
       <block title="Charger l'image">
            <p>Pour être dessinée, l'image doit être un objet, qui devra dans un premier temps charger celle-ci 
                en mémoire. Pour ce faire, on doit 
           d'abord déclarer l'objet image : <code>var img = new Image();</code> puis lui affecter une source :
           <code>img.src = "path/to/image";</code>. </p>
           <p>Cette dernière instruction provoquera le chargement de l'image, ce n'est que lorsque celle-ci sera 
           complètement chargée qu'elle sera affichée. </p>
           <p>Pour contrôler plus finement le chargement et l'affichage des images, on peut s'appuyer sur 
               l'événement <code>onload</code> et lui affecter une fonction qui sera exécutée lorsque l'image 
           sera disponible et prête pour l'affichage (appel asynchrone). </p>
           <p>A noter que ceci  n'est pas nécessaire si l'image est issue d'un marqueur <code>&lt;img&gt;</code> déjà présent/visible
           dans la page.</p>
       </block>
       
  </slide>    

          
   <slide>
        <title>Le canvas</title>
        
        <block title="Dessiner des images">
            <div class="playground nocss h40" data-href="./examples/jsCanvas4.html" data-opened="js"></div>
        </block>
    </slide>
        
   <slide>
        <title>Le canvas</title>
        
        <block title="Animations">
            <p>Pour réaliser une animation dans un canvas, on applique le principe consistant à afficher une image, 
                l'effacer, afficher l'image suivante, l'effacer, etc. 
            </p>
            <p>Pour éviter des effets de clignotement, et avoir un framerate qui soit constant, on s'appuie sur 
            la méthode <code>requestAnimationFrame</code> pour laquelle nous avions vu un polyfill précédemment. </p>
            <p>Cette méthode réalisant l'affichage sera appelée à intervalle régulier et permettra de précharger 
            l'image suivante alors que l'image courante (elle-même précalculée précédemment) est encore affichée.</p>
        </block>
        
   </slide>    

   <slide>
        <title>Le canvas</title>
        
        <block title="Exemple d'animation">
            <div class="playground nocss" data-href="./examples/jsCanvas5.html" data-opened="js"></div>
        </block>
        
    </slide>            
    
    <slide>
        <title>Le canvas</title>
        
        <block title="Exemple complet avec écouteurs d'événements">
            <div class="playground nocss" data-href="./examples/jsCanvas6.html" data-opened="js"></div>
        </block>
        
    </slide>    
    
    
    <section>Les trucs à connaître</section>
    
    <slide outline class="no-navigation section currentSection currentSubsection">
        <title>Plan du chapitre</title>
    </slide>
            
    <subsection>Les bibliothèques/environnements actuels</subsection>    
        
    <subsubsection>La bibliothèque jQuery</subsubsection>

    <slide>
        <title>L'ancêtre : jQuery</title>
        
        <block title="Qu'est-ce que c'est ?">
            <p>jQuery est une bilbiothèque pour Javascript apparue en janvier 2006. Il s'agit d'un ensemble de fonctions et d'objets qui 
            visent à faciliter les traitements en Javascript, en proposant des routines prêtes-à-l'emploi 
            pour diverses actions :</p>
            <ul>
                <li>Manipuler le DOM : sélectionner des éléments, modifier leurs attributs, etc.</li>
                <li>Parcourir le contenu de la page et restructurer l'arbre DOM.</li>
                <li>Changer le style des éléments</li>
                <li>Animer l'interface : cacher/montrer des blocs, déplacer des éléments sur la page, etc.</li>
                <li>Simplifier les appels AJAX, notamment en cachant les objets à instancier, les erreurs, etc.</li>
            </ul>
            <p>Par ailleurs, de nombreux plugins ont été développés sur la base de jQuery (voir <url>http://plugins.jquery.com/</url>
                pour plus de détails).</p>
        </block>
    </slide>
        
   <slide>
        <title>L'ancêtre : jQuery</title>
         <block title="jQuery n'invente rien">
        <p>Tout ce que fait jQuery peut être (re)fait par quelqu'un ayant un minimum de connaissance sur Javascript (cf. contenu 
            de ce chapitre). </p>
        <p>Depuis 10 ans, la popularité de jQuery a diminué, car les nombreux polyfills proposés pour harmoniser les traitements
            entre les navigateurs sont devenus obsolètes du fait d'un meilleur support des fonctions basiques du standard ECMAScript
            par les navigateurs. </p>
        <p>Aujourd'hui jQuery n'a plus vocation qu'à garantir un compatibilité ascendante vers les 
            navigateurs les plus anciens. Cette bibliothèque apporte surtout des raccourcis qui font 
            gagner (un peu) en clarté. </p>
        </block>
        
        <block title="Comment l'utiliser ?">
        <p>Pour profiter de jQuery, il suffit d'inclure le fichier de script, qui aura été soit téléchargé, 
            <br><code>&lt;script src="./chemin/local/vers/jquery.js"&gt;&lt;/script&gt;</code><br>            
            soit obtenu via un CDN : 
            <br><code>&lt;script src="https://code.jquery.com/jquery-3.2.1.js"&gt;&lt;/script&gt;</code> 
            </p>
        </block>
        
    </slide>           
        
    <slide>
        <title>jQuery</title>
        
        <block title="Fonctionnement">
        <p>jQuery repose sur une seule fonction, éponyme, <code>jQuery(...)</code> ou son alias <code>$(...)</code>, 
            qui va permettre, en fonction de son paramètre, de donner accès à tout un ensemble de fonctions 
            applicables. Le paramètre peut être : </p>
        <ul>
            <li>une fonction qui sera exécutée dès que le DOM sera disponible (équivalent à l'événement <code>DOMContentLoaded</code>)</li>
            <li>un sélecteur CSS qui retournera le(s) élément(s) correspondant(s) à ce sélecteur, pour permettre de réaliser divers traitements comme changer le contenu HTML, changer le style, modifier le sous-arbre DOM, etc. (équivalent à <code>document.querySelectorAll(...)</code>)</li>
            <li>un élément HTML, le document, ou l'objet window : un objet jQuery correspondant est alors renvoyé, proposant diverses
            fonctions pour simplifier/harmoniser les traitements possibles sur ceux-ci. </li>
            <li>une ou plusieurs balises HTML, ce qui va avoir pour effet de créer ces éléments. </li>
        </ul>
        <p>Les objets jQuery encapsulent les objets du DOM natifs en proposant de nouvelles fonctions pour réaliser des traitements 
            personnalisés. </p>
        </block>
        
    </slide>           
        
    <slide>
        <title>jQuery</title>
        
        <block title="Quelques exemples de syntaxe/fonctions avec JQuery">
        <table>
            <tr>
                <td>Instruction</td><td>Signification</td>
            </tr>    
            <tr>
                <td><code>var divs = $("div");</code></td>
                <td>Sélecteur d'éléments</td>
            </tr>
            <tr>
                <td><code>var monlien = $('#lien')</code></td>
                <td>Sélecteur d'identifiant</td>
            </tr>
            <tr>
                <td><code>$(document).ready(function() {...));</code></td>
                <td rowspan="2">Assignation d'événements</td>
            </tr>
            <tr>
                <td><code>$('#lien').click(function() {...));</code></td>
            </tr>
            <tr>
                <td><code>var newDiv = $('&lt;div/>')</code></td>
                <td>Création d'un nouvel élément</td>
            </tr>
            <tr>
                <td><code>$('body').append($('&lt;p/>'))</code></td>
                <td>Ajout d'un élément en fin de noeud.</td>
            </tr>
            <tr>
                <td><code>$('#monBloc').empty()</code></td>
                <td>Supprimer tous les enfants d'un élément.</td>
            </tr>
            <tr>
                <td><code>var papa = $('#monBloc').parent()</code></td>
                <td>Récupération du parent d'un élément.</td>
            </tr>
            <tr>
                <td><code>$('#monImage').attr(src,"chemin/vers/image.ext")</code></td>
                <td>Modification des attributs d'un élément.</td>
            </tr>
            <tr>
                <td><code>$('#monBloc').toggle(classe)</code></td>
                <td>Affectation/désaffectation d'une classe de l'élément.</td>
            </tr>
        </table>
        </block>

        <p>Pour un tour d'horizon complet de jQuery et de ses possibilités :<br>
            <url>https://jquery.com/</url> et 
            <url>https://www.w3schools.com/jquery/default.asp</url></p>
        
    </slide>    
        
    <subsubsection>VanillaJS</subsubsection>
        
    <slide>
        <title>Vanilla JS</title>
        
        <block title="Qu'est-ce que c'est ?">
            <p>Vanilla JS n'est pas un framework, mais plutôt un courant de pensée, qui considère que jQuery a fait
            son temps et qu'il existe des équivalents à toutes les fonctions jQuery en pur Javascript (plain js). </p>
            
            <p>Par ailleurs, l'utilisation de jQuery rajoute une surcouche au temps d'exécution non négligeable, par 
            rapport à des fonctions natives de Javascript. (voir <url>https://jsperf.com/jquery-vs-native-element-performance</url>)</p>
    
            <p>Cette vision des choses n'est pas partagée par tout le monde, notamment pour les développeurs qui ne sont pas à 
                la recherche de performances, et/ou ceux qui souhaitent maintenir une compatibilité ascendante (notamment 
                vers IE8). </p>
        </block>

        <block title="Quelques liens">
        <ul>
            <li><url>https://plainjs.com/</url></li>
            <li><url>http://youmightnotneedjquery.com/</url></li>
            <li><url>http://putaindecode.io/fr/articles/js/de-jquery-a-vanillajs/</url></li>
        </ul>
        </block>
        
    </slide>           
    
    <subsubsection>React, Vue, Angular, etc.</subsubsection>    
    
    <slide>
        <title>Frameworks de développement d'applications</title>
        
        <block title="Qu'est-ce que c'est ?">
            <p>Depuis quelques années se sont imposés des frameworks destinés au développement d'applications
                riches en Javascript.</p>
            <p>En effet, Javascript est de plus en plus utilisé pour développer des applications légères
            (par opposition aux <i>clients lourds</i> écrits en Java que l'on trouve encore, ex. ADE). 
            </p>
        </block>
        
        <block title="Les types d'archicture">
            <p>On peut actuellement diviser les architectures d'applications web en deux types :</p>
            <ul>
                <li>les applications multi-pages (MPA) ou sites statiques, dans lesquelles un serveur construit 
                (ou simplement lit) le contenu de la page qu'il envoie au client. </li>
                <li>les applications simple page (SPA) où le serveur est interrogé ponctuellement par le client, 
                    et c'est ce dernier qui met à jour dynamiquement la page en modifiant le DOM. </li>
                </li>
            </ul>
            <p>Bien évidemment, c'est souvent un mix des deux techniques qui est utilisé. </p>
        </block>
        
    </slide>

    <slide>
        <title>Frameworks de développement d'applications</title>
        
        <block title="Les architectures Multi-Page Application">
            <p>C'est l'architecture que l'on connait et que l'on manipule depuis l'an dernier (UE LW du S4). </p>
            <img src="images/archi-MPA.png" style="width: 80%;">
        </block>
        
    </slide>

    <slide>
        <title>Frameworks de développement d'applications</title>
        
        <block title="Les architectures Single-Page Application">
            <p>Il s'agit des architectures qui peuvent désormais être mises en place, grâce aux appels asynchrones 
            (AJAX) et la réécriture du DOM proposées par Javascript</p>
            <img src="images/archi-SPA.png" style="width: 80%;">
        </block>

        
    </slide>

    <slide>
        <title>Frameworks de développement d'applications</title>
        
        <block title="Les frameworks actuels">
            <p>En très large majorité, les frameworks actuels visent principalement à produire des applications 
                single-page et se focalisent sur les capacités de rendus côté client (mise à jour efficace du DOM, 
                fonctionnalités de vérification des saisies, support mobile, etc.). </p>
            <p>Ces frameworks sont composés : </p>
            <ul>
                <li>d'un langage spécifique (Javascript ou un dérivé) </li>
                <li>de bibliothèques de code pour réaliser des traitements spécifiques et récurrents
                (réécriture du DOM, réponse des événements spécifiques, etc.) </li>
                <li>d'un ensemble de composants pré-définis (widgets, styles, etc.) </li>
                <li>d'une organisation de l'arborescence de développement qui leur est propre</li>
                <li>d'une logique de fonctionnement d'une application qui leur est propre</li>
            </ul>
            <p>Contrairement à jQuery il ne s'agit donc pas juste de quelques fonctions "raccourcis". </p>
        </block>
    
        <p>Voir : <url>https://www.lambdatest.com/blog/best-javascript-framework-2020/</url></p>
        
    </slide>

    <slide>
        <title>Frameworks de développement d'applications</title>
        
        <block title="1. ReactJS">
            <img src="images/frameworks-react.png" style="width: 30%;">
            <ul>
                <li>Produit par une équipe de développeurs de Facebook en 2011 et rendu open source en 2013. </li>
                <li>React s'appuie sur un langage de description de composants 
                    nommé JSX (mélange de Javascript et de HTML/XML) pour la spécification de composants.
                </li>
                <li>Chaque composant est une classe qui étend un composant React générique, avec son modèle
                de données (attributs de classe) et ses opérations internes. </li>
                <li>Une méthode particulière <code>render</code> a pour objectif de produire le composant visualisé 
                avec les interactions qui lui sont associées. </li>
            </ul>
        </block>

    </slide>

    <slide>
        <title>Frameworks de développement d'applications</title>        
        <block title="application React simple (tic-tac-toe pris du tutoriel React)">
            <div class="playground nohtml nocss h50 nooutput" data-href="./examples/js-React.html" data-opened="js"></div>
        </block>
        
        <p>Pour ceux qui sont intéressés : <url>https://fr.reactjs.org/tutorial/tutorial.html</url></p>
        
    </slide>

    <slide>
        <title>Frameworks de développement d'applications</title>
        
        <block title="2. VueJS">
            <img src="images/Vue-js.svg" style="width: 30%;">
            <ul>
                <li>Initialement développé par Evan You en 2014, principalement destiné à des application simple page. </li>
                <li>Vue s'appuie sur un système de templates pour décrire des composants. </li>
                <li>Chaque composant est un triplet HTML+CSS+JS. </li>
                <li>On utilise un modèle pour les données et les traitements (objets Javascript) qui sont rendus sur une 
                page HTML contenant des directives spécifiques (<code>{{ ... }}</code> ou <code>@click</code>, etc.) </li>
                <li>Ce framework permet d'ajouter des attributs préfixés par <code>v-</code> aux balises HTML pour donner des directives spécifiques
                    (boucles, affichages conditionnels, etc.). </li>
                <li>L'application maintient un lien constant entre les données manipulées (modèle) et les informations affichées 
                (vue). </li>
            </ul>
        </block>
        
        <p>Pour ceux qui sont intéressés, une rapide démo des possibilités de Vue.js <url>https://vimeo.com/247494684</url></p>        

    </slide>

    <slide>
        <title>Frameworks de développement d'applications</title>
        
        <block title="3. Angular">
            <img src="images/frameworks-angularjs.png" style="width: 30%;">
            <ul>
                <li>1ère version sortie en 2010, 2nde version (actuelle) reprise en 2016</li>
                <li>Modèle MVC, liaisons bi-directionnelles entre les données affichées dans les éléments HTML et le modèle de données de l'application.</li>
                <li>Arborescence spécifique (1 dossier par composant, conventions de nommage des fichiers HTML, CSS, et JS propre au composant).</li>
                <li>S'appuie sur TypeScript pour l'écriture de composants.</li>
                <li>Enrichit le code HTML des composants avec des constructions spécifiques (préfixées par <code>*ng</code> pour les directives, 
                    <code>{{ ... }}</code> pour l'inclusion de données du modèle, etc.) 
                </li>
            </ul>
        </block>
        
    </slide>
        
        
    <slide>
        <title>Un bilan sur les frameworks Javascript</title>
        
        <block title="Attention aux versions différentes">
            <p>Un framework n'est ni plus ni moins qu'un logiciel, qui évolue, contient des bugs, qu'il faut
            apprendre à prendre en main, etc. </p>
            <p>Comme dans tous les frameworks, ceux-ci ont une croissance rapide, et un cycle de versions
            relativement court, qui nécessite constamment de suivre les évolutions. </p>
            <p>Ainsi, certains concepts présents dans une version donnée peuvent être abandonnés dans les versions 
            ultérieures &rarr; dette technique (mise à jour de l'appli suite à une montée de version du framework).</p>
        </block>
        
        <block title="Prenez garde aux effets de mode">
            <p>Les frameworks en général souffrent de plusieurs problèmes majeurs : </p>
            <ul>
                <li>le coût d'apprentissage de ceux-ci : il faut comprendre la logique du framework et 
                s'approprier les différentes possbilités qu'il offre. Par ailleurs, il existe généralement 
                tout un écosystème de plugins qu'il sera difficile d'ignorer. <br>
                Si le coût d'apprentissage initial peut s'amortir rapidement, l'effort de veille technologique
                et d'apprentissage des évolutions/nouveautés des nouvelles versions n'est pas négligeable. </li>
                <li>les effets de mode : de nombreux frameworks existent autour de Javascript (Angular, ReactJS 
                    <url>https://reactjs.org/</url>, VueJS <url>https://vuejs.org/</url>, 
                pour ne citer qu'eux). A l'heure actuelle, il est difficile, voire impossible d'avoir une
                visibilité sur la durée de vie de ces environnements. Il y a 5 ans, on ne parlait pas d'Angular
                et EmberJS (<url>https://www.emberjs.com/</url>) était le framework Javascript préféré des entreprises. 
                L'an dernier, React était incontournable. Cette année VueJS lui dispute la première place... et ensuite ?</li>
                <!--
                <li>la mise en place d'une usine à gaz : avec l'arrivée de NodeJS côté serveur, le développement
                de code Javascript est devenu de plus en plus complexe avec le temps. Même si, au final, on 
                écrit toujours du code tel qu'il a été présenté dans ce cours. Ce qui va changer, c'est l'organisation
                des sources, dictée par tel ou tel framework. Beaucoup de développement web se fait maintenant côté
                serveur, avec NodeJS, et ses nombreux modules existants, même si ceux-ci visent à être déployés côté 
                client (en utilisant du coup, une extension permettant de packager le tout pour l'exécuter dans un 
                navigateur -- comme Browserify). </li>
                -->
            </ul>
        </block>
        
    </slide>    
        

    <subsection>Quelques pratiques à connaître</subsection>

    <slide outline class="no-navigation section currentSection currentSubsection">
        <title>Plan du chapitre</title>
    </slide>

    <subsubsection>Organiser son code en modules</subsubsection>

    <slide>
        <title>Les modules en Javascript</title>
        
        <p>Apparus avec ES2015, les modules Javascript permettent de factoriser du code, en vue de le réutiliser 
        (par exemple entre le côté client, et le côté serveur). L'idée est ainsi de diviser un programme JS
        en plusieurs modules que l'on peut importer (soit au début du code, soit dynamiquement depuis ES2020). 
        </p>
        
        <block title="Les commandes principales pour créer et utiliser des modules">
        
            <p>On trouvera deux commandes principales : </p>

            <ul>
                <li><code>export</code> qui sera dans le fichier décrivant le module, et permettra de définir 
                quels éléments de ce fichier (classes, objets, constantes, fonctions) sont <i>exportés</i> 
                c'est-à-dire visibles de l'extérieur. </li>
                <li><code>import</code> qui sera placé le fichier souhaitant accéder aux contenus ainsi exportés. 
                </li>
            </ul>
        </block>
        
    </slide>


    <slide>
        <title>Exporter des fonctionnalités dans un module</title>
        
        <block title="Syntaxe d'un export">
            <p>Plusieurs syntaxes sont possibles :</p>
            <ul>
                <li>un export à chaque déclaration : <code>export var toto = 42;</code></li>
                <li>un export séparé des déclarations : <code>export { <i>var1</i> [as <i>newVar1</i>], <i>fonc2</i> };</code> </li>
            </ul>
            <p>Il est possible de nommer un export par défaut avec le mot clé <code>default</code> : </p>
            <ul>
                <li>au moment de sa déclaration : <code>export default function() { ... }</code><br>On note que potentiellement pour une fonction ou une classe celle-ci peut ne pas être nommée.</li>
                <li>avec un export séparé : <code>export { var1 as default }</code></li>
            </ul>
        </block>

        <block title="Concernant le fichier contenant le code du module">

            <p>Habituellement, on nommera les fichiers de module JS avec l'extension <code>.js</code>. </p>
            
            <p>Dans un module, <code>this</code> n'est pas défini (valeur <code>undefined</code>). </p>
            
        </block>

    </slide>

    <slide>
        <title>Exporter des fonctionnalités dans un module</title>
        
        <block title="Exports">
            <p>On considère le fichier <code>export.js</code> visible <a href="./examples/export.js" target="_blank">ici</a>. </p>
            <div class="playground nocss nohtml nooutput h50" data-href="./examples/jsModules1.html" data-opened="js"></div>
        </block>


    </slide>



    <slide>
        <title>Importer des fonctionnalités depuis un module</title>
        
        <block title="Syntaxe d'un import">
            <p>Plusieurs syntaxes sont possibles :</p>
            <ul>
                <li>importer un ensemble nommé de fonctionnalités : <code>import { <i>var1</i>, <i>func1</i> } from "./chemin/vers/fichier.js";</code></li>
                <li>importer et renommer des fonctionnalités : <code>import { <i>var1</i> as <i>newVar1</i> } from "./chemin/vers/fichier.js";</code> <br>(utile en cas d'homonymes dans plusieurs imports différents)</li>
                <li>importer dans un objet : <code>import * as <i>obj</i> from "./chemin/vers/fichier.js"</code></li>
                <li>importer la fonctionnalité par défaut (si elle existe) : <code>import f from "./chemin/vers/fichier.js"</code></li>
            </ul>
        </block>

    </slide>



    <slide>
        <title>Importer des fonctionnalités depuis un module</title>
                <block title="Concernant le fichier contenant le code du module">

            <ul>
            <li>L'importation ne pourra se faire que depuis un script qui est lui-même un module (déclaré dans le navigateur avec 
                une balise <code>&lt;script type="module">...&lt;/script></code> éventuellement lui aussi dans un fichier séparé). </li>

            <li>Attention, les modules ne fonctionnent que s'ils sont hébergés &rarr; pas d'accès avec le protocole <code>file://</code> 
                sous peine d'une erreur CORS. </li>

            <li>Le script qui est importé est chargé en mode <code>defer</code> : l'exécution du reste du script n'est pas bloquée, le navigateur 
                attend que le document soit entièrement chargé pour s'exécuter, et l'ordre de chargement des scripts est respecté. </li>
            
            <li>Un module n'est évalué que la première fois où il est importé. </li>
        </ul>
                
        </block>

    </slide>

    <slide>
        <title>Importer des fonctionnalités</title>
        
        <block>
            <title>Import du fichier précédent</title>

            <div class="playground nocss nojs console noiframe h50" data-href="./examples/jsModules2.html" data-opened="html"></div>

        </block>
        
    </slide>


    <subsubsection>Assurer la rétro-compatibilité avec BabelJS</subsubsection>

    <slide>
        <title>Assurer la rétro-compatibilité avec BabelJS</title>
        
        <p>On l'a vu, tous les navigateurs ne sont pas toujours à jour, et certaines vieilles versions de navigateurs 
        peuvent ne pas reconnaître certaines constructions du langage trop récentes. </p>
        
        <block title="BabelJS, qu'est-ce que c'est ?">
            <p><a href="https://babeljs.io/" target="_blank">BabelJS</a> est un compilateur Javascript qui permet de 
            traduire un code Javascript "récent" (ES2015+) dans un langage compatible avec la majorité des navigateurs. 
            Babel propose les fonctionnalités suivantes : </p>
            <ul>
                <li>tranformation de la syntaxe (ex. <code>`salut ${toi}`</code> &rarr; <code>"salut " + toi</code>)</li>
                <li>ajout de prothèses d'émulation (polyfills) pour les fonctions qui n'existeraient pas</li>
                <li>réécriture de code source (par exemple pour les opérateurs Rest, Spread, ou les gabarits étiquetés)</li>
                <li>etc.</li>
            </ul>
        </block>
        
        <p>BabelJS fonctionne aussi bien côté client que côté serveur où il s'interface ainsi avec les principaux 
        environnements de déploiement de code. </p>
        
    </slide>    
        

    <subsubsection>Minifier son code</subsubsection>        

    <slide>
        <title>Minification</title>
        
        <block title="Qu'est-ce que c'est ?">
            <p>La minification consiste à réduire la taille du code. C'et un procédé classique qui permet d'éviter
            de surcharger le réseau en réduisant le nombre de caractères utilisés. </p>
            <p>Pour ce faire, le minifier va généralement retirer les commentaires, espaces et retours à la ligne 
            superflus. Il peut également procéder à un renommage des variables pour les réduires à un nombre réduit 
            de caractères.</p>
        </block>
        
        <block title="Quelques outils">
        <ul>
            <li>JSCompress : <url>https://jscompress.com/</url></li>    
            <li>javascript-minifier : <url>https://javascript-minifier.com/</url></li>
            <li>minify : <url>https://www.minifier.org/</url></li>
            <li>jsmin : <url>http://www.crockford.com/javascript/jsmin.html</url></li>
        </ul>
        </block>
        
    </slide>           

        
    <subsubsection>Obfusquer son code</subsubsection>        
    
    <slide>
        <title>Obfuscation</title>
        
        <block title="Qu'est-ce que c'est ?">
            <p>Offusquer son code consiste à le rendre illisible, en renommant les variables, en réécrivant les fonctions, 
                les instructions, etc. Il s'agit ainsi d'en faire un code impénétrable : celui-ci est impossible à 
            comprendre pour un être humain, mais il reste complètement valide et compréhensible par l'ordinateur. </p>
            <p>Cette pratique est désignée par une terminologie variée : offusquer, assombrir, obscurcir. </p>
        </block>
        
        <block title="A quoi cela sert-il ?">
            <p>Ce mécanisme, qui n'est pas limité au code, a pour objectif de masquer des informations sensibles. </p>
            <p>Javascript est un langage interprété, et donc le navigateur doit avoir accès au code source pour l'exécuter. 
                Si le navigateur y a accès, l'utilisateur aussi. </p>
            <p>On utilisera alors le principe d'offuscation pour faire en sorte que, bien que l'humain ait accès au code, 
            il ne lui est pas possible de le comprendre et de l'exploiter (extraire les algorithmes, la logique métier, 
                les informations sensibles, etc.). </p>
        </block>
    </slide>
        
    
    <slide>
        <title>Obfuscation</title>
        
        <block title="Comment faire ?">
            <p>Ce n'est bien évidemment pas à vous de réécrire votre code ! Des outils/compilateurs peuvent le faire 
            pour vous. Ceux-ci peuvent s'utiliser comme application desktop, en ligne de commande ou en ligne. 
            Quelques références : </p>
            <ul>
                <li>Javascript Obfuscator : <url>https://javascriptobfuscator.com/</url> - en ligne ou desktop</li>
                <li>Closure compiler : <url>https://developers.google.com/closure/compiler/</url></li>
                <li>Jscrambler : <url>https://jscrambler.com/</url></li>
                <li>YUI compressor : <url>http://yui.github.io/yuicompressor/</url></li>
                <li>JS-Obfus : <url>http://stunnix.com/prod/jo/</url></li>
            </ul>
            <p>Et plein d'autres...</p>
        </block>
        
    </slide>      


    <slide class="no-navigation">
        <title>Conclusion</title>
        
        <p>Côté client, Javascript est capable de beaucoup de choses.</p>
        
        <p>Ce cours a proposé un petit tour d'horizon, mais il ne saurait être exhaustif, tant le domaine est mouvant. 
        Ces quelques diapos ont juste pour objectif de vous donner des clés pour comprendre ce que vous pourrez trouver
        par la suite. Il n'a bien évidemment pas la prétention de faire de vous des experts de Javascript en à peine 
        30 heures. </p>
        
        <p>N'ayant pas peur d'aller découvrir certains aspects qui ont été volontairement mis de côté (par exemple, les
            service workers) et d'aller les appréhender par vous-même. <strong>C'est l'essence du métier que vous visez.</strong></p>
        
        <p>N'hésitez pas à vous documenter par vous-même et gardez l'habitude de vous tenir informé des dernières 
            techniques/technologies/tendances.</p>
        
    </slide>
            
    
    <slide options="no-navigation">

        <title2>Prochaine (et dernière) étape...</title2>
        
        <title1>Javascript côté serveur !</title1>
        
    </slide>
    
</slideshow>
    
    
</body>
    
</html>